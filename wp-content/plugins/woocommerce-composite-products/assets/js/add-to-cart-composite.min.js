function wc_cp_toggle_element(a,b,c){return a.data("animating")!==!0&&(a.hasClass("closed")?(setTimeout(function(){b.slideDown({duration:300,queue:!1,always:function(){a.data("animating",!1),"function"==typeof c&&c()}})},40),a.removeClass("closed").addClass("open"),a.data("animating",!0)):(setTimeout(function(){b.slideUp({duration:300,queue:!1,always:function(){a.data("animating",!1),"function"==typeof c&&c()}})},40),a.removeClass("open").addClass("closed"),a.data("animating",!0)),!0)}function wc_cp_scroll_viewport(a,b){var c,d,e="undefined"==typeof b.partial||b.partial,f="undefined"==typeof b.offset?50:b.offset,g="undefined"==typeof b.timeout?5:b.timeout,h="undefined"==typeof b.duration?250:b.duration,i="undefined"!=typeof b.queue&&b.queue,j="undefined"!=typeof b.always_on_complete&&b.always_on_complete,k="undefined"!=typeof b.scroll_method&&b.scroll_method,l=!1,m=$wc_cp_window,n=$wc_cp_document;c="undefined"==typeof b.on_complete||b.on_complete===!1?function(){return!1}:b.on_complete;var o=function(){if("relative"===a)d=m.scrollTop()-f,l=!0;else if("absolute"===a)d=f,l=!0;else if(a.length>0&&a.is(":visible")&&!a.wc_cp_is_in_viewport(e)){var b=f;b="bottom"===k||a.hasClass("scroll_bottom")?m.height()-a.outerHeight(!0)-f:"middle"===k?m.height()/3*2-a.outerHeight(!0)-f:wc_composite_params.scroll_viewport_top_offset,d=a.offset().top-b,a.offset().top<d&&(d=a.offset().top),l=!0}if(l){d>n.height()-m.height()&&(d=n.height()-m.height()-100);var g=$wc_cp_html.scrollTop(),o=$wc_cp_body;$wc_cp_html.scrollTop($wc_cp_html.scrollTop()-1),g!=$wc_cp_html.scrollTop()&&(o=$wc_cp_html),o.animate({scrollTop:d},{duration:h,queue:i,always:c})}else j&&c()};g>0?setTimeout(function(){o()},g):o()}function wc_cp_woocommerce_number_format(a){var b=wc_composite_params.currency_format_decimal_sep,c=wc_composite_params.currency_position,d=wc_composite_params.currency_symbol,e=wc_composite_params.currency_format_trim_zeros,f=wc_composite_params.currency_format_num_decimals;if("yes"==e&&f>0){for(var g=0;g<f;g++)b+="0";a=a.replace(b,"")}var h="";return"left"==c?h='<span class="amount">'+d+a+"</span>":"right"==c?h='<span class="amount">'+a+d+"</span>":"left_space"==c?h='<span class="amount">'+d+" "+a+"</span>":"right_space"==c&&(h='<span class="amount">'+a+" "+d+"</span>"),h}function wc_cp_number_format(a){var b=wc_composite_params.currency_format_num_decimals,c=wc_composite_params.currency_format_decimal_sep,d=wc_composite_params.currency_format_thousand_sep,e=a,f=isNaN(b=Math.abs(b))?2:b,g="undefined"==typeof c?",":c,h="undefined"==typeof d?".":d,i=e<0?"-":"",j=parseInt(e=Math.abs(+e||0).toFixed(f))+"",k=(k=j.length)>3?k%3:0;return i+(k?j.substr(0,k)+h:"")+j.substr(k).replace(/(\d{3})(?=\d)/g,"$1"+h)+(f?g+Math.abs(e-j).toFixed(f).slice(2):"")}function wc_cp_join(a){var b="",c=a.length;if(c>0)for(var d=0,e=0;e<c;e++)d++,b=1==c||1==d?a[e]:wc_composite_params.i18n_comma_sep.replace("%s",b).replace("%v",a[e]);return b}function wc_cp_get_variation_data(a,b){b="undefined"!=typeof b&&b;var c=a.find(".attribute-options"),d=c.length,e=[],f="";return 0===d?"":(c.each(function(a){var b=jQuery(this),c=b.find("select").val();if(""===c)return e=[],f="",!1;var g=b.data("attribute_label"),h=b.find("select option:selected").text();e.push({meta_key:g,meta_value:h}),f=f+'<span class="meta_element"><span class="meta_key">'+g+':</span> <span class="meta_value">'+h+"</span>",a!==d-1&&(f+='<span class="meta_element_sep">, </span>'),f+="</span>"}),b?f:e)}var wc_cp_composite_scripts={},$wc_cp_body=!1,$wc_cp_html=jQuery("html"),$wc_cp_window=jQuery(window),$wc_cp_document=jQuery(document),wc_cp_block_params={message:null,fadeIn:0,fadeOut:0,overlayCSS:{background:"rgba( 255, 255, 255, 0 )",opacity:1}},wc_cp_block_wait_params={message:null,fadeIn:200,fadeOut:200,overlayCSS:{background:"rgba( 255, 255, 255, 0 )",opacity:.6}};jQuery.fn.wc_cp_is_in_viewport=function(a,b,c){var d=$wc_cp_window;if(!(this.length<1)){var e=this.length>1?this.eq(0):this,f=e.get(0),g=d.width(),h=d.height(),i=b!==!0||f.offsetWidth*f.offsetHeight;if(c=c?c:"vertical","function"==typeof f.getBoundingClientRect){var j=f.getBoundingClientRect(),k=j.top>=0&&j.top<h,l=j.bottom>0&&j.bottom<=h,m=j.left>=0&&j.left<g,n=j.right>0&&j.right<=g,o=a?k||l:k&&l,p=a?m||n:m&&n;if("both"===c)return i&&o&&p;if("vertical"===c)return i&&o;if("horizontal"===c)return i&&p}else{var q=d.scrollTop(),r=q+h,s=d.scrollLeft(),t=s+g,u=e.offset(),v=u.top,w=v+e.height(),x=u.left,y=x+e.width(),z=a===!0?w:v,A=a===!0?v:w,B=a===!0?y:x,C=a===!0?x:y;if("both"===c)return!!i&&A<=r&&z>=q&&C<=t&&B>=s;if("vertical"===c)return!!i&&A<=r&&z>=q;if("horizontal"===c)return!!i&&C<=t&&B>=s}}},jQuery.fn.wc_get_composite_script=function(){var a=jQuery(this);if(!a.hasClass("composite_form"))return!1;var b=a.data("script_id");return"undefined"!=typeof wc_cp_composite_scripts[b]&&wc_cp_composite_scripts[b]},function(a,b){function c(c){var e=this;this.composite_id=c.$composite_data.data("container_id"),this.$composite_data=c.$composite_data,this.$composite_form=c.$composite_form,this.$composite_add_to_cart_button=c.$composite_form.find(".composite_add_to_cart_button"),this.$composite_navigation=c.$composite_form.find(".composite_navigation"),this.$composite_navigation_top=c.$composite_form.find(".composite_navigation.top"),this.$composite_navigation_bottom=c.$composite_form.find(".composite_navigation.bottom"),this.$composite_navigation_movable=c.$composite_form.find(".composite_navigation.movable"),this.$composite_pagination=c.$composite_form.find(".composite_pagination"),this.$composite_summary=c.$composite_form.find(".composite_summary"),this.$composite_summary_widget=a(".widget_composite_summary").filter(function(){return a(this).find(".widget_composite_summary_content_"+e.composite_id).length>0}),this.$components=c.$composite_form.find(".component"),this.$steps={},this.$composite_availability=c.$composite_data.find(".composite_availability"),this.$composite_price=c.$composite_data.find(".composite_price"),this.$composite_message=c.$composite_data.find(".composite_message"),this.$composite_button=c.$composite_data.find(".composite_button"),this.$composite_status=c.$composite_form.find(".composite_status"),this.$composite_transition_helper=c.$composite_form.find(".scroll_show_component"),this.$composite_form_blocker=c.$composite_form.find(".form_input_blocker"),this.timers={on_resize_timer:!1},this.ajax_url="yes"===wc_composite_params.use_wc_ajax?woocommerce_params.wc_ajax_url:woocommerce_params.ajax_url,this.debug_tab_count=0,this.settings=c.$composite_data.data("composite_settings"),this.is_initialized=!1,this.has_transition_lock=!1,this.steps=[],this.step_factory=new d.WC_CP_Step_Factory,this.scenarios=new d.WC_CP_Scenarios_Manager(this),this.actions=new d.WC_CP_Actions_Dispatcher(this),this.filters=new d.WC_CP_Filters_Manager,this.router=!1,this.data_model=!1,this.view_classes=new d.WC_CP_Views(this),this.model_classes=new d.WC_CP_Models(this),this.composite_summary_view=!1,this.composite_pagination_view=!1,this.composite_navigation_view=!1,this.composite_validation_view=!1,this.composite_availability_view=!1,this.composite_price_view=!1,this.composite_add_to_cart_button_view=!1,this.composite_summary_widget_views=[],this.api={navigate_to_step:function(a){var b=e.get_step_by("id",a);return!1!==b&&void e.navigate_to_step(b)},show_previous_step:function(){e.show_previous_step()},show_next_step:function(){e.show_next_step()},get_steps:function(){return e.get_steps()},get_components:function(){return e.get_components()},get_step:function(a){return e.get_step(a)},get_step_by:function(a,b){return e.get_step_by(a,b)},get_step_title:function(a){var b=e.get_step_by("id",a);return!1!==b&&b.get_title()},get_step_slug:function(a){var b=e.get_step_by("id",a);return!1!==b&&b.step_slug},get_current_step:function(){return e.get_current_step()},get_previous_step:function(){return e.get_previous_step()},get_next_step:function(){return e.get_next_step()},get_composite_totals:function(){return e.data_model.get("totals")},get_composite_stock_status:function(){return e.data_model.get("is_in_stock")?"in-stock":"out-of-stock"},get_composite_availability:function(){var a=e.composite_availability_view.get_components_availability_string();return""===a&&!1!==e.composite_availability_view.$composite_stock_status&&(a=e.composite_availability_view.$composite_stock_status.clone().wrap("<div></div>").parent().html()),a},get_composite_validation_status:function(){return e.data_model.get("passes_validation")?"pass":"fail"},get_composite_validation_messages:function(){return e.data_model.get("validation_messages")},get_composite_configuration:function(){var b={};return 0!==e.get_components().length&&(a.each(e.get_components(),function(a,c){var d=e.api.get_component_configuration(c.component_id);b[c.component_id]=d}),b)},get_component_totals:function(a){return!1!==e.get_step_by("id",a)&&e.data_model.get("component_"+a+"_totals")},get_component_stock_status:function(a){var b=e.get_step_by("id",a);return!1!==b&&(b.step_validation_model.get("is_in_stock")?"in-stock":"out-of-stock")},get_component_availability:function(a){var b=e.get_step_by("id",a);if(!1===b)return!1;var c=b.$component_summary_content.find(".component_wrap .stock");return c.length>0?c.clone().wrap("<div></div>").parent().html():""},get_component_validation_status:function(a){var b=e.get_step_by("id",a);return!1!==b&&(b.step_validation_model.get("passes_validation")?"pass":"fail")},get_component_validation_messages:function(a,b){var c=e.get_step_by("id",a);if(!1===c)return!1;var d="composite"===b?c.step_validation_model.get("composite_messages"):c.step_validation_model.get("component_messages");return d},get_component_configuration:function(a){var b=e.get_step_by("id",a),c=!1;return!1===b?c:(c={title:b.get_title(),selection_title:b.get_selected_product_title(!1),selection_meta:b.get_selected_product_meta(!1),product_id:b.get_selected_product(!1),variation_id:b.get_selected_variation(!1),product_valid:b.is_selected_product_valid(),variation_valid:b.is_selected_variation_valid(),quantity:b.get_selected_quantity(),product_type:b.get_selected_product_type()},c=e.filters.apply_filters("component_configuration",[c,b]))},is_priced_per_product:function(){e.console_log("error","\nMethod 'WC_CP_Composite::api::is_priced_per_product' is deprecated since v3.7.0. Use 'WC_CP_Composite::api::is_component_priced_individually' instead.")},is_component_priced_individually:function(a){return"yes"===e.data_model.price_data.is_priced_individually[a]}},this.init=function(){e.$composite_data.trigger("wc-composite-initializing",[e]),this.actions.add_action("initialize_composite",function(){e.init_steps()},10,this).add_action("initialize_composite",function(){e.init_models()},20,this).add_action("initialize_composite",function(){e.actions.init()},30,this).add_action("initialize_composite",function(){e.on_resize_handler()},40,this).add_action("initialize_composite",function(){e.init_views()},50,this).add_action("initialize_composite",function(){e.scenarios.init()},60,this).add_action("initialize_composite",function(){e.console_log("debug:events","\nValidating Steps:"),e.debug_tab_count=e.debug_tab_count+2,a.each(e.get_steps(),function(a,b){b.validate()}),e.debug_tab_count=e.debug_tab_count-2,e.console_log("debug:events","\nValidation complete.")},70,this).add_action("initialize_composite",function(){e.get_current_step().show_step()},80,this).add_action("initialize_composite",function(){e.init_router()},90,this),this.actions.do_action("initialize_composite"),e.is_initialized=!0,this.actions.add_action("composite_initialized",function(){e.data_model.init()},10,this).add_action("composite_initialized",function(){e.render_views()},20,this),this.actions.do_action("composite_initialized")},this.init_router=function(){var a=e.get_current_step(),c=b.Router.extend({has_initial_route:!1,is_initialized:!1,routes:{":step_slug":"show_step"},show_step:function(a){var b=encodeURIComponent(a),c=e.get_step_by("slug",b);c&&(this.is_initialized||(this.has_initial_route=!0),c.is_locked()?(window.alert(wc_composite_params.i18n_step_not_accessible.replace(/%s/g,c.get_title())),e.router.navigate(e.get_current_step().step_slug)):(this.is_initialized&&wc_cp_scroll_viewport(e.$composite_form,{timeout:0,partial:!1,duration:0,queue:!1}),c.show_step()))}});$wc_cp_body.hasClass("single-product")&&$wc_cp_body.hasClass("postid-"+e.composite_id)&&(e.router=new c,b.history.start(),e.router.is_initialized=!0,"single"===e.settings.layout||!1!==e.router.has_initial_route||window.location.hash||e.router.navigate(a.step_slug,{trigger:!1}))},this.init_steps=function(){e.console_log("debug:events","\nInitializing Steps..."),"paged"===e.settings.layout?"componentized"===e.settings.layout_variation?(e.$composite_form.find(".multistep.active").removeClass("active"),e.$composite_data.addClass("multistep active"),e.$composite_summary_widget.hide()):e.$composite_data.prev().hasClass("multistep")?(e.$composite_data.addClass("multistep"),e.$composite_data.hide(),e.$composite_data.hasClass("composite_added_to_cart")&&(e.$composite_form.find(".multistep.active").removeClass("active"),e.$composite_data.addClass("active"))):(e.$composite_data.show(),e.$composite_data.find(".component_title .step_index").hide()):"progressive"===e.settings.layout?(e.$components.show(),e.$composite_data.show()):"single"===e.settings.layout&&(e.$components.show(),e.$composite_data.show()),e.$steps=e.$composite_form.find(".multistep"),e.$composite_form.children(".component, .multistep").each(function(b){var c=e.step_factory.create_step(e,a(this),b);e.steps[b]=c}),e.$composite_navigation.removeAttr("style")},this.get_ajax_url=function(a){return"yes"===wc_composite_params.use_wc_ajax?this.ajax_url.toString().replace("%%endpoint%%",a):this.ajax_url},this.navigate_to_step=function(a){"object"==typeof a&&"function"==typeof a.show_step&&(a.show_step(),this.allow_history_updates()&&this.router.navigate(a.step_slug))},this.allow_history_updates=function(){return!1!==e.router&&"yes"===this.settings.update_browser_history&&e.is_initialized},this.show_previous_step=function(){a.each(e.get_steps(),function(a,b){if(b.is_previous())return e.navigate_to_step(b),!1})},this.show_next_step=function(){a.each(e.get_steps(),function(a,b){if(b.is_next())return e.navigate_to_step(b),!1})},this.get_steps=function(){return this.steps},this.get_components=function(){var b=[];return a.each(this.steps,function(a,c){c.is_component()&&b.push(c)}),b},this.get_step=function(b){var c=!1;return a.each(e.get_steps(),function(a,d){if(d.step_id==b)return c=d,!1}),c},this.get_step_by=function(b,c){var d=!1;return("id"===b||"index"===b||"slug"===b)&&(a.each(e.get_steps(),function(a,e){if("id"===b&&String(e.step_id)===String(c)||"index"===b&&String(a)===String(c)||"slug"===b&&String(e.step_slug).toUpperCase()===String(c).toUpperCase())return d=e,!1}),d)},this.get_current_step=function(){var b=!1;return a.each(e.get_steps(),function(a,c){if(c.is_current())return b=c,!1}),b},this.set_current_step=function(b){var c=this.settings.layout,d=this.settings.layout_variation,e=this.get_current_step(),f=this.get_next_step(),g=this.get_previous_step(),h=!1,i=!1;"paged"===c&&"componentized"===d?h=i=this.get_step_by("id","review"):a.each(this.get_steps(),function(a,c){!1===h&&c.step_index>b.step_index&&c.is_visible()&&(h=c),c.step_index<b.step_index&&c.is_visible()&&(i=c)}),e._is_current=!1,b._is_current=!0,e.$el.removeClass("active"),b.$el.addClass("active"),!1!==f&&(f._is_next=!1,f.$el.removeClass("next")),!1!==h&&(h._is_next=!0,h.$el.addClass("next")),!1!==g&&(g._is_previous=!1,g.$el.removeClass("prev")),!1!==i&&(i._is_previous=!0,i.$el.addClass("prev"))},this.get_previous_step=function(){var b=!1;return a.each(e.get_steps(),function(a,c){if(c.is_previous())return b=c,!1}),b},this.get_next_step=function(){var b=!1;return a.each(e.get_steps(),function(a,c){if(c.is_next())return b=c,!1}),b},this.on_resize_handler=function(){var b=e.$composite_form.width();b<=wc_composite_params.small_width_threshold?e.$composite_form.addClass("small_width"):e.$composite_form.removeClass("small_width"),b>wc_composite_params.full_width_threshold?e.$composite_form.addClass("full_width"):e.$composite_form.removeClass("full_width"),wc_composite_params.legacy_width_threshold&&(b<=wc_composite_params.legacy_width_threshold?e.$composite_form.addClass("legacy_width"):e.$composite_form.removeClass("legacy_width")),e.is_initialized&&a.each(e.get_components(),function(a,b){if(b.component_selection_view.is_relocated()){var c=b.component_selection_view.get_content_relocation_params();if(c.relocate){var d=b.$component_options.find(".component_option_content_container"),e=c.reference;e.after(d)}}})},this.console_log=function(b,c){if(window.console&&"undefined"!=typeof c){var d=!1;if("error"===b?d=!0:_.contains(wc_composite_params.script_debug_level,b)?d=!0:a.each(wc_composite_params.script_debug_level,function(a,c){if(b.indexOf(c)>-1)return d=!0,!1}),d){for(var f="",g=e.debug_tab_count;g>0;g--)f+="\t";c="function"==typeof c.substring&&"\n"===c.substring(0,1)?c.replace("\n","\n"+f):f+c,window.console.log(c)}}},this.init_models=function(){a.each(e.get_steps(),function(a,b){b.step_validation_model=new e.model_classes.Step_Validation_Model(b),b.step_visibility_model=new e.model_classes.Step_Visibility_Model(b),b.step_access_model=new e.model_classes.Step_Access_Model(b)}),a.each(e.get_components(),function(a,b){b.component_options_model=new e.model_classes.Component_Options_Model(b),b.component_selection_model=new e.model_classes.Component_Selection_Model(b)}),e.data_model=new e.model_classes.Composite_Data_Model},this.init_views=function(){e.console_log("debug:events","\nInitializing Views..."),this.composite_validation_view=new e.view_classes.Composite_Validation_View({is_in_widget:!1,el:e.$composite_message,model:e.data_model}),this.composite_price_view=new e.view_classes.Composite_Price_View({is_in_widget:!1,el:e.$composite_price,model:e.data_model}),this.composite_availability_view=new e.view_classes.Composite_Availability_View({is_in_widget:!1,el:e.$composite_availability,model:e.data_model}),this.composite_add_to_cart_button_view=new e.view_classes.Composite_Add_To_Cart_Button_View({is_in_widget:!1,el:e.$composite_button,$el_button:e.$composite_add_to_cart_button,model:e.data_model}),this.composite_status_view=new e.view_classes.Composite_Status_View({el:e.$composite_status,$el_content:e.$composite_status.find(".wrapper"),model:e.data_model}),e.$composite_pagination.length>0&&(e.composite_pagination_view=new e.view_classes.Composite_Pagination_View({el:e.$composite_pagination})),e.$composite_summary.length>0&&(e.composite_summary_view=new e.view_classes.Composite_Summary_View({is_in_widget:!1,el:e.$composite_summary})),e.$composite_navigation.length>0&&(e.composite_navigation_view=new e.view_classes.Composite_Navigation_View({el:e.$composite_navigation})),e.$composite_summary_widget.length>0&&e.$composite_summary_widget.each(function(a,b){e.composite_summary_widget_views.push(new e.view_classes.Composite_Widget_View({widget_count:a+1,el:b}))}),a.each(e.get_steps(),function(a,b){b.validation_view=new e.view_classes.Step_Validation_View(b,{el:b.$component_message,model:b.step_validation_model}),b.step_title_view=new e.view_classes.Step_Title_View(b,{el:b.$step_title})}),a.each(e.get_components(),function(a,b){b.component_options_view=new e.view_classes.Component_Options_View(b,{el:b.$component_options,model:b.component_options_model}),b.component_pagination_view=new e.view_classes.Component_Pagination_View(b,{el:b.$component_pagination,model:b.component_options_model}),b.component_selection_view=new e.view_classes.Component_Selection_View(b,{el:b.$component_content,model:b.component_selection_model})}),a.each(e.get_components(),function(a,b){b.component_selection_view.init_dependencies()})},this.render_views=function(){e.console_log("debug:views","\nRendering Views..."),e.debug_tab_count=e.debug_tab_count+2,a.each(e.get_components(),function(a,b){b.component_selection_view.update_selection_title(),b.component_options_view.render(),b.component_pagination_view.render()}),a.each(e.get_steps(),function(a,b){b.step_title_view.render_navigation_state(),b.step_title_view.render_index()}),!1!==e.composite_pagination_view&&e.composite_pagination_view.render(),!1!==e.composite_summary_view&&e.composite_summary_view.render(),!1!==e.composite_navigation_view&&e.composite_navigation_view.render("transition"),a.each(e.composite_summary_widget_views,function(a,b){b.composite_summary_view.render()}),e.debug_tab_count=e.debug_tab_count-2,e.console_log("debug:views","\nRendering complete."),e.$composite_form.removeClass("cp-no-js"),e.$composite_form.find(".cp-no-js-msg").remove()},this.block=function(a){this.$composite_form.block(wc_cp_block_params),a.block(wc_cp_block_wait_params),e.has_transition_lock=!0},this.unblock=function(a){this.$composite_form.unblock(),a.unblock(),e.has_transition_lock=!1}}var d={};d.WC_CP_Models=function(c){this.Composite_Data_Model=function(d){var e=b.Model.extend({price_data:c.$composite_data.data("price_data"),$nyp:!1,initialize:function(){var b={passes_validation:!0,validation_messages:[],status_messages:[],is_in_stock:!0,stock_statuses:[],totals:{price:"",regular_price:"",price_incl_tax:"",price_excl_tax:""}};a.each(c.get_components(),function(a,c){b["component_"+c.component_id+"_totals"]={price:"",regular_price:"",price_incl_tax:"",price_excl_tax:""}}),this.set(b),this.price_data.suffix_exists=""!==wc_composite_params.price_display_suffix,this.price_data.suffix_contains_price_incl=wc_composite_params.price_display_suffix.indexOf("{price_including_tax}")>-1,this.price_data.suffix_contains_price_excl=wc_composite_params.price_display_suffix.indexOf("{price_excluding_tax}")>-1,c.actions.add_action("component_addons_changed",this.addons_changed_handler,10,this),c.actions.add_action("component_nyp_changed",this.nyp_changed_handler,10,this),c.actions.add_action("component_quantity_changed",this.quantity_changed_handler,20,this),c.actions.add_action("component_selection_changed",this.selection_changed_handler,30,this),c.actions.add_action("component_selection_content_changed",this.selection_content_changed_handler,30,this),c.actions.add_action("component_availability_changed",this.availability_changed_handler,10,this),c.actions.add_action("component_validation_message_changed",this.validation_message_changed_handler,10,this),c.actions.add_action("component_totals_changed",this.component_totals_changed_handler,10,this);var d=c.$composite_data.find(".nyp");d.length>0&&(this.$nyp=d,this.price_data.base_price=d.data("price"),c.$composite_data.on("woocommerce-nyp-updated-item",{model:this},function(a){var b=a.data.model;b.price_data.base_price=b.$nyp.data("price"),b.price_data.base_regular_price=b.$nyp.data("price"),b.calculate_totals()}))},init:function(){c.console_log("debug:models","\nInitializing composite data model..."),c.debug_tab_count=c.debug_tab_count+2,this.update_validation(),this.update_totals(),this.update_availability(),c.debug_tab_count=c.debug_tab_count-2},addons_changed_handler:function(a){return!!c.is_initialized&&void this.update_totals(a)},nyp_changed_handler:function(a){return!!c.is_initialized&&void this.update_totals(a)},selection_changed_handler:function(){return!!c.is_initialized&&void this.update_totals()},availability_changed_handler:function(){return!!c.is_initialized&&void this.update_availability()},selection_content_changed_handler:function(){return!!c.is_initialized&&void this.update_totals()},quantity_changed_handler:function(a){return!!c.is_initialized&&void this.update_totals(a)},validation_message_changed_handler:function(){this.update_validation()},component_totals_changed_handler:function(){this.calculate_totals()},update_validation:function(){var a=[];this.is_purchasable()?a=this.get_validation_messages():a.push(wc_composite_params.i18n_unavailable_text),c.console_log("debug:models","\nUpdating 'Composite_Data_Model' validation state... Attribute count: \"validation_messages\": "+a.length+', Attribute: "passes_validation": '+(0===a.length).toString()),c.debug_tab_count=c.debug_tab_count+2,this.set({validation_messages:a,passes_validation:0===a.length}),c.debug_tab_count=c.debug_tab_count-2},get_validation_messages:function(){var b=[];a.each(c.get_steps(),function(c,d){var e=d.get_title();a.each(d.get_validation_messages("composite"),function(c,f){if(d.is_review())b.push({sources:!1,content:f.toString()});else{var g=!1;b.length>0&&a.each(b,function(a,c){if(c.content===f){var d=c.sources,h=c.content;return d.push(e),b[a]={sources:d,content:h},g=!0,!1}}),g||b.push({sources:[e],content:f.toString()})}})});var d=[];return b.length>0&&a.each(b,function(a,b){if(b.sources===!1)d.push(b.content);else{var c=wc_cp_join(b.sources);d.push(wc_composite_params.i18n_validation_issues_for.replace("%c",c).replace("%e",b.content))}}),d=c.filters.apply_filters("composite_validation_messages",[d])},is_purchasable:function(){return"no"!==this.price_data.is_purchasable},update_availability:function(){var b=[],d=!0;a.each(c.get_components(),function(a,c){b.push(c.step_validation_model.get("is_in_stock"))}),d=!_.contains(b,!1),c.console_log("debug:models","\nUpdating 'Composite_Data_Model' availability... Attribute: \"stock_statuses\": "+b.toString()+', Attribute: "is_in_stock": '+d.toString()),c.debug_tab_count=c.debug_tab_count+2,this.set({stock_statuses:b,is_in_stock:d}),c.debug_tab_count=c.debug_tab_count-2},update_totals:function(b){var d=this;c.console_log("debug:models","\nUpdating 'Composite_Data_Model' totals..."),c.debug_tab_count=c.debug_tab_count+2,"undefined"==typeof b?(a.each(c.get_components(),function(a,b){d.update_component_prices(b)}),this.calculate_subtotals()):(this.update_component_prices(b),this.calculate_subtotals(b)),c.debug_tab_count=c.debug_tab_count-2},calculate_totals:function(b){var d,e=this,f="undefined"==typeof b?e.price_data:b,g=Number(f.base_price),h=Number(f.base_regular_price),i=Number(f.base_price_tax);c.console_log("debug:models","\nAdding totals..."),d=this.get_taxed_totals(g,h,i),f.base_display_price=d.price,f.total=d.price,f.regular_total=d.regular_price,f.total_incl_tax=d.price_incl_tax,f.total_excl_tax=d.price_excl_tax,a.each(c.get_components(),function(a,c){var d="undefined"==typeof b?e.get("component_"+c.component_id+"_totals"):b["component_"+c.component_id+"_totals"];f.total+=d.price,f.regular_total+=d.regular_price,f.total_incl_tax+=d.price_incl_tax,f.total_excl_tax+=d.price_excl_tax});var j={price:f.total,regular_price:f.regular_total,price_incl_tax:f.total_incl_tax,price_excl_tax:f.total_excl_tax};return j=c.filters.apply_filters("composite_totals",[j]),"undefined"!=typeof b?j:(c.debug_tab_count=c.debug_tab_count+2,this.set({totals:j}),c.debug_tab_count=c.debug_tab_count-2,void 0)},get_taxed_totals:function(a,b,c){var d={price:a,regular_price:b,price_incl_tax:a,price_excl_tax:a};return c>0&&("yes"===wc_composite_params.prices_include_tax?(d.price_incl_tax=a,d.price_excl_tax=a/c):(d.price_incl_tax=a*c,d.price_excl_tax=a),"incl"===wc_composite_params.tax_display_shop?(d.price=d.price_incl_tax,"yes"===wc_composite_params.prices_include_tax?d.regular_price=b:d.regular_price=b*c):(d.price=d.price_excl_tax,"yes"===wc_composite_params.prices_include_tax?d.regular_price=b/c:d.regular_price=b)),d},calculate_subtotals:function(b,d){var e=this,f="undefined"==typeof d?e.price_data:d;if(b="undefined"!=typeof b&&b,a.each(c.get_components(),function(a,g){if(!1!==b&&b.component_id!==g.component_id)return!0;var h={price:0,regular_price:0,price_incl_tax:0,price_excl_tax:0},i=f.quantities[g.component_id],j="variable"===g.get_selected_product_type()?g.get_selected_variation(!1):g.get_selected_product(!1),k=f.prices_tax[g.component_id],l=i*(f.regular_prices[g.component_id]+f.addons_prices[g.component_id]),m=i*(f.prices[g.component_id]+f.addons_prices[g.component_id]);c.console_log("debug:models",'Calculating "'+g.get_title()+'" totals...'),"yes"===wc_composite_params.calc_taxes?j>0&&i>0&&(m>0||l>0)&&(h=e.get_taxed_totals(m,l,k)):(h.price=m,h.regular_price=l,h.price_incl_tax=m,h.price_excl_tax=m),h=c.filters.apply_filters("component_totals",[h,g]),"undefined"==typeof d?(c.console_log("debug:models","Updating 'Composite_Data_Model' component totals... Attribute: \"component_"+g.component_id+'_totals".'),c.debug_tab_count=c.debug_tab_count+2,e.set("component_"+g.component_id+"_totals",h),c.debug_tab_count=c.debug_tab_count-2):f["component_"+g.component_id+"_totals"]=h}),"undefined"!=typeof d)return f},update_component_prices:function(a){c.console_log("debug:models",'Fetching "'+a.get_title()+'" price data...');var b=a.get_selected_quantity(),d=a.$component_data.data("custom");this.price_data.prices[a.component_id]=Number(a.$component_data.data("price")),this.price_data.regular_prices[a.component_id]=Number(a.$component_data.data("regular_price")),this.price_data.prices_tax[a.component_id]=1,"undefined"!=typeof d&&"undefined"!==d.price_tax&&(this.price_data.prices_tax[a.component_id]=Number(d.price_tax)),this.price_data.addons_prices[a.component_id]=Number(a.component_selection_model.get("selected_addons")),b>0?this.price_data.quantities[a.component_id]=parseInt(b):this.price_data.quantities[a.component_id]=0},add_status_message:function(b,d){var e=a.extend(!0,[],this.get("status_messages"));e.push({message_source:b,message_content:d}),c.console_log("debug:models",'Adding "'+b+'" status message: "'+d+'"...'),this.set({status_messages:e})},remove_status_message:function(a){c.console_log("debug:models",'Removing "'+a+'" status message...');var b=_.filter(this.get("status_messages"),function(b){return b.message_source!==a});this.set({status_messages:b})}}),f=new e(d);return f},this.Step_Validation_Model=function(a,d){var e=a,f=b.Model.extend({initialize:function(){var a={passes_validation:!0,is_in_stock:!0,component_messages:[],composite_messages:[]};this.set(a),c.actions.add_action("component_quantity_changed",this.quantity_changed_handler,10,this),c.actions.add_action("component_selection_changed",this.selection_changed_handler,20,this),c.actions.add_action("component_selection_content_changed",this.selection_content_changed_handler,20,this)},quantity_changed_handler:function(){c.is_initialized&&a.step_id===e.step_id&&e.validate()},selection_changed_handler:function(){c.is_initialized&&e.validate()},selection_content_changed_handler:function(a){c.is_initialized&&a.step_id===e.step_id&&e.validate()},update:function(a,b){var d={passes_validation:a,is_in_stock:b,component_messages:e.get_validation_messages("component"),composite_messages:e.get_validation_messages("composite")};c.console_log("debug:models","\nUpdating 'Step_Validation_Model': \""+e.get_title()+'", Attribute: "passes_validation": '+d.passes_validation.toString()+', Attribute: "is_in_stock": '+d.is_in_stock.toString()),this.get("passes_validation")!==d.passes_validation?c.console_log("debug:models","Validation state changed.\n"):c.console_log("debug:models","Validation state unchanged.\n"),_.isEqual(this.get("component_messages"),d.component_messages)?c.console_log("debug:models","Validation message unchanged.\n"):c.console_log("debug:models","Validation message changed.\n"),this.get("is_in_stock")!==d.is_in_stock?c.console_log("debug:models","Stock state changed.\n"):c.console_log("debug:models","Stock state unchanged.\n"),c.debug_tab_count=c.debug_tab_count+2,this.set(d),c.debug_tab_count=c.debug_tab_count-2}}),g=new f(d);return g},this.Step_Access_Model=function(d,e){var f=d,g=b.Model.extend({is_lockable:!1,initialize:function(){var b=this,d={is_locked:!1};this.set(d),this.is_lockable="single"!==c.settings.layout&&("componentized"!==c.settings.layout_variation||"yes"===c.settings.sequential_componentized_progress&&!1===f.is_review()),this.is_lockable&&a.each(c.get_steps(),function(a,c){return!!c.is_review()||void(c.step_index<f.step_index&&(b.listenTo(c.step_validation_model,"change:passes_validation",b.update_lock_state),
b.listenTo(c.step_access_model,"change:is_locked",b.update_lock_state)))}),this.listenTo(f.step_visibility_model,"change:is_visible",this.update_lock_state)},update_lock_state:function(){var b=!1;!1===f.is_visible()?b=!0:this.is_lockable&&a.each(c.get_steps(),function(a,c){return c.step_index!==f.step_index&&(!1===c.is_visible()||(c.step_access_model.get("is_locked")?(b=!0,!1):!1===c.step_validation_model.get("passes_validation")?(b=!0,!1):void 0))}),c.console_log("debug:models","\nUpdating 'Step_Access_Model': \""+f.get_title()+'", Attribute: "is_locked": '+b.toString()),this.get("is_locked")!==b?c.console_log("debug:models","Lock state changed.\n"):c.console_log("debug:models","Lock state unchanged.\n"),c.debug_tab_count=c.debug_tab_count+2,this.set({is_locked:b}),c.debug_tab_count=c.debug_tab_count-2}}),h=new g(e);return h},this.Step_Visibility_Model=function(d,e){var f=d,g=b.Model.extend({initialize:function(){var a={is_visible:!0};this.set(a),f.is_component()&&c.actions.add_action("active_scenarios_changed",this.update_visibility_state,5,this)},update_visibility_state:function(){var b=c.scenarios.get_active_scenarios(),d=c.scenarios.filter_scenarios_by_type(b,"conditional_components"),e=!0;c.console_log("debug:models",'\nUpdating "'+f.get_title()+'" visibility...'),c.debug_tab_count=c.debug_tab_count+2,c.console_log("debug:models",'Active "Hide Components" Scenarios: ['+d+"]");var g=c.scenarios.get_scenario_data().scenario_settings.conditional_components;d.length>0&&"undefined"!=typeof g&&a.each(g,function(a,b){_.contains(d,a.toString())&&_.contains(b,f.component_id.toString())&&(e=!1)}),c.console_log("debug:models","\nUpdating 'Step_Visibility_Model': \""+f.get_title()+'", Attribute: "is_visible": '+e.toString()),this.get("is_visible")!==e?c.console_log("debug:models","Visibility state changed.\n"):c.console_log("debug:models","Visibility state unchanged.\n"),c.debug_tab_count=c.debug_tab_count+2,this.set({is_visible:e}),c.debug_tab_count=c.debug_tab_count-2,c.debug_tab_count=c.debug_tab_count-2}}),h=new g(e);return h},this.Component_Options_Model=function(d,e){var f=d,g=b.Model.extend({available_options_data:[],xhr:!1,initialize:function(){this.available_options_data=f.find_options_data();var a=[];this.available_options_data.length>0&&(a=_.pluck(this.available_options_data,"option_id"));var b={filters:f.find_active_filters(),orderby:f.find_order_by(),page:f.find_pagination_param("page"),pages:f.find_pagination_param("pages"),available_options:a,active_options:a.slice(),options_state:{active:_.pluck(_.where(this.available_options_data,{is_in_view:!0}),"option_id"),inactive:[]},options_in_scenarios:c.scenarios.clean_masked_scenarios(c.scenarios.get_scenarios_by_type("compat_group"),f.component_id)};this.set(b),"single"===c.settings.layout?c.actions.add_action("active_scenarios_updated",this.refresh_options_state,10,this):(c.actions.add_action("active_scenarios_changed",this.refresh_options_state,10,this),c.actions.add_action("available_options_changed_"+f.step_id,this.available_options_changed_handler,10,this),c.actions.add_action("active_step_changed_"+f.step_id,this.active_step_changed_handler,10,this))},active_step_changed_handler:function(){this.refresh_options_state(f)},available_options_changed_handler:function(){this.refresh_options_state(f)},reload_options_on_scenarios_change:function(){var a=!1;return f.hide_disabled_products()&&f.has_options_style("thumbnails")&&f.get_max_results()>f.get_results_per_page()&&(!1===f.append_results()?a=!0:_.pluck(_.where(this.available_options_data,{is_in_view:!0}),"option_id").length<f.get_max_results()&&(a=!0)),a},request_options:function(b,d){var e=this;this.set(_.omit(b,"page"));var g={action:"woocommerce_show_component_options",component_id:f.component_id,composite_id:c.composite_id,load_page:b.page?b.page:1,selected_option:f.get_selected_product(!1),filters:this.get("filters"),orderby:this.get("orderby"),options_in_scenarios:this.reload_options_on_scenarios_change()?this.get("options_in_scenarios"):[]};this.xhr&&this.xhr.abort(),this.xhr=a.post(c.get_ajax_url(g.action),g,function(a){e.trigger("component_options_data_loaded",a,d),"success"===a.result?"reload"===d?(e.available_options_data=a.options_data,c.scenarios.set_component_scenario_data(f.component_id,a.scenario_data),e.set(a.pagination_data),e.refresh_options(_.pluck(e.available_options_data,"option_id"))):"append"===d&&(e.available_options_data=_.union(_.where(e.available_options_data,{is_in_view:!0}),_.map(a.options_data,function(a){return _.extend(a,{is_appended:!0})})),c.scenarios.merge_component_scenario_data(f.component_id,a.scenario_data),e.set(a.pagination_data),e.refresh_options(_.pluck(e.available_options_data,"option_id")),e.available_options_data=_.map(e.available_options_data,function(a){return _.omit(a,"is_appended")})):window.alert(a.message),c.actions.do_action("component_options_loaded",[f])},"json")},refresh_options:function(a){c.console_log("debug:models","\nUpdating 'Component_Options_Model': \""+f.get_title()+'", Attribute: "available_options": '+_.map(a,function(a){return""===a?"0":a})),c.debug_tab_count=c.debug_tab_count+2,_.isEqual(this.get("available_options"),a)?this.refresh_options_state(f):this.set({available_options:a}),c.debug_tab_count=c.debug_tab_count-2},refresh_options_state:function(b){c.console_log("debug:models","\nUpdating 'Component_Options_Model': \""+f.get_title()+'", Attribute: "active_options"...'),c.debug_tab_count=c.debug_tab_count+2;var d=[],e=[],g={active:[],inactive:[]},h=b.step_index,i=f.component_id,j=c.scenarios.get_scenario_data().scenario_data,k=j[i],l=!1,m=!1,n=!1,o=!1,p=!1;if(b.is_review()&&(h=1e3),l=!0,m=!0,e=c.scenarios.filter_scenarios_by_type(c.scenarios.calculate_active_scenarios(f,m,l),"compat_group"),c.console_log("debug:models","\nReference scenarios: ["+e+"]"),c.console_log("debug:models","Removing any scenarios where the current component is masked..."),e=c.scenarios.clean_masked_scenarios(e,i),0===e.length&&e.push("0"),c.console_log("debug:models","\nUpdating 'Component_Options_Model': \""+f.get_title()+'", Attribute: "options_in_scenarios"...'),_.isEqual(this.get("options_in_scenarios"),e)?c.console_log("debug:models","\nActive options scenarios unchanged - ["+this.get("options_in_scenarios")+"] => ["+e+"].\n"):c.console_log("debug:models","\nActive options scenarios changed - ["+this.get("options_in_scenarios")+"] => ["+e+"].\n"),c.debug_tab_count=c.debug_tab_count+2,this.set({options_in_scenarios:e}),c.debug_tab_count=c.debug_tab_count-2,0 in k){for(var q=k[0],r=0;r<q.length;r++){var s=q[r];if(a.inArray(s,e)>-1){n=!0;break}}g.inactive.push("")}else!1===f.is_visible()&&(n=!0);if(n&&(c.console_log("debug:models","Component set as optional."),d.push(""),g.active.push("")),a.each(this.available_options_data,function(b,h){var i=h.option_id,j=i in k?k[i]:[],l=!1;c.console_log("debug:models","Updating selection #"+i+":"),c.console_log("debug:models","\tSelection in scenarios: ["+j+"]");for(var m=0;m<j.length;m++){var n=j[m];if(a.inArray(n,e)>-1){l=!0;break}}l?(c.console_log("debug:models","\tSelection enabled."),d.push(i),h.is_in_view&&g.active.push(i)):(c.console_log("debug:models","\tSelection disabled."),h.is_in_view&&g.inactive.push(i),f.get_selected_product(!1)===i&&(o=!0,o&&c.console_log("debug:models","\t--- Selection invalid.")))}),"variable"===f.get_selected_product_type()){var t=f.get_selected_variation(),u=f.$component_data.data("product_variations");c.console_log("debug:models","\tChecking variations..."),t>0&&c.console_log("debug:models","\t\t--- Stored variation is #"+t);for(var v=0;v<u.length;v++){var w=u[v].variation_id,x=w in k?k[w]:[],y=!1;c.console_log("debug:models","\t\tChecking variation #"+w+":"),c.console_log("debug:models","\t\tSelection in scenarios: ["+x+"]");for(var z=0;z<x.length;z++){var A=x[z];if(a.inArray(A,e)>-1){y=!0;break}}y?(c.console_log("debug:models","\t\tVariation enabled."),d.push(w.toString()),g.active.push(w.toString())):(c.console_log("debug:models","\t\tVariation disabled."),g.inactive.push(w.toString()),f.get_selected_variation(!1).toString()===w.toString()&&(p=!0,p&&c.console_log("debug:models","\t\t--- Selection invalid.")))}}c.console_log("debug:models","Done.\n"),c.debug_tab_count=c.debug_tab_count-2,_.isEqual(this.get("active_options"),d)?c.console_log("debug:models","\nActive options unchanged - ["+_.map(this.get("active_options"),function(a){return""===a?"0":a})+"] => ["+_.map(d,function(a){return""===a?"0":a})+"].\n"):c.console_log("debug:models","\nActive options changed - ["+_.map(this.get("active_options"),function(a){return""===a?"0":a})+"] => ["+_.map(d,function(a){return""===a?"0":a})+"].\n"),c.debug_tab_count=c.debug_tab_count+2,this.set({active_options:d}),c.debug_tab_count=c.debug_tab_count-2,_.isEqual(this.get("options_state"),g)?c.console_log("debug:models","\nOptions state unchanged.\n"):c.console_log("debug:models","\nOptions state changed.\n"),c.debug_tab_count=c.debug_tab_count+2,this.set({options_state:g}),c.debug_tab_count=c.debug_tab_count-2,("single"===c.settings.layout||f.is_current())&&(c.console_log("debug:models",'\nChecking current "'+f.get_title()+'" selections:'),o?c.console_log("debug:models","\nProduct selection invalid.\n\n"):p?(c.console_log("debug:models","\nVariation selection invalid - resetting...\n\n"),c.debug_tab_count=c.debug_tab_count+2,f.component_selection_view.resetting_variation=!0,f.$component_summary_content.find(".reset_variations").trigger("click"),f.component_selection_view.resetting_variation=!1,f.component_options_view.render(),c.debug_tab_count=c.debug_tab_count-2):c.console_log("debug:models","...looking good!"))}}),h=new g(e);return h},this.Component_Selection_Model=function(d,e){var f=d,g=b.Model.extend({selected_product:"",selected_variation_data:"",selected_product_image_data:!1,selected_variation_image_data:!1,initialize:function(){var b="";f.component_options_model.available_options_data.length>0&&a.each(f.component_options_model.available_options_data,function(a,c){if(c.is_selected)return b=c.option_id,!1});var c={selected_product:b,selected_variation:f.find_selected_product_param("variation_id"),selected_quantity:f.find_selected_product_param("quantity"),selected_addons:0,selected_nyp:0};this.selected_product=c.selected_product,this.selected_product_image_data=f.find_selected_product_param("product_image_data"),this.selected_variation_image_data=f.find_selected_product_param("variation_image_data"),this.set(c)},request_details:function(b){var d=this,e={action:"woocommerce_show_composited_product",product_id:b,component_id:f.component_id,composite_id:c.composite_id};a.ajax({type:"POST",url:c.get_ajax_url(e.action),data:e,timeout:15e3,dataType:"json",success:function(a){d.selected_product=b,d.trigger("component_selection_details_loaded",a)},error:function(){d.selected_product=f.get_selected_product(!1),d.trigger("component_selection_details_load_error")}})},update_selected_product:function(){var a="",b=f.find_selected_product_param("variation_id"),d=f.find_selected_product_param("quantity"),e=this.get("selected_product")!==this.selected_product,g=this.get("selected_variation")!==b,h=this.get("selected_quantity")!==d;e&&(this.selected_product_image_data=f.find_selected_product_param("product_image_data"),a='Attribute: "selected_product": #'+(""===this.selected_product?"0":this.selected_product)),g&&(b>0?(this.selected_variation_data=f.find_selected_product_param("variation_data"),this.selected_variation_image_data=f.find_selected_product_param("variation_image_data")):(this.selected_variation_data="",this.selected_variation_image_data=!1),a=a+(""!==a?", ":"")+'Attribute: "selected_variation": #'+(""===b?"0":b)),h&&(a=a+(""!==a?", ":"")+'Attribute: "selected_quantity": '+d),(e||g||h)&&c.console_log("debug:models","\nUpdating 'Component_Selection_Model': \""+f.get_title()+'": '+a),c.debug_tab_count=c.debug_tab_count+2,this.set({selected_product:this.selected_product,selected_variation:b,selected_quantity:d,selected_addons:0,selected_nyp:0}),c.debug_tab_count=c.debug_tab_count-2,this.trigger("selected_product_updated",this)},update_selected_variation:function(){var a=f.find_selected_product_param("variation_id");this.get("selected_variation")!==a&&(a>0?(this.selected_variation_data=f.find_selected_product_param("variation_data"),this.selected_variation_image_data=f.find_selected_product_param("variation_image_data")):(this.selected_variation_data="",this.selected_variation_image_data=!1),c.console_log("debug:models","\nUpdating 'Component_Selection_Model': \""+f.get_title()+'", Attribute: "selected_variation": #'+(""===a?"0":a))),c.debug_tab_count=c.debug_tab_count+2,this.set({selected_variation:a}),c.debug_tab_count=c.debug_tab_count-2,this.trigger("selected_variation_updated",this)},update_selected_quantity:function(){var a=f.find_selected_product_param("quantity");this.get("selected_quantity")!==a&&c.console_log("debug:models","\nUpdating 'Component_Selection_Model': \""+f.get_title()+'", Attribute: "selected_quantity": '+a),c.debug_tab_count=c.debug_tab_count+2,this.set({selected_quantity:a}),c.debug_tab_count=c.debug_tab_count-2},update_selected_addons:function(){var a=f.find_selected_product_param("addons_price");this.get("selected_addons")!==a&&c.console_log("debug:models","\nUpdating 'Component_Selection_Model': \""+f.get_title()+'", Attribute: "selected_addons_price": '+a),c.debug_tab_count=c.debug_tab_count+2,this.set({selected_addons:a}),c.debug_tab_count=c.debug_tab_count-2},update_nyp:function(){var a=f.find_selected_product_param("nyp_price");this.get("selected_nyp")!==a&&c.console_log("debug:models","\nUpdating 'Component_Selection_Model': \""+f.get_title()+'", Attribute: "nyp_price": '+a),f.$component_data.data("price",a),f.$component_data.data("regular_price",a),c.debug_tab_count=c.debug_tab_count+2,this.set({selected_nyp:a}),c.debug_tab_count=c.debug_tab_count-2}}),h=new g(e);return h}},d.WC_CP_Views=function(c){this.Composite_Status_View=function(a){var d=b.View.extend({is_active:!1,template:!1,worker:!1,$el_content:!1,initialize:function(a){var b=this;this.template=wp.template("wc_cp_composite_status"),this.$el_content=a.$el_content,this.listenTo(this.model,"change:status_messages",this.status_changed);var c=function(){var a=this;this.timer=!1,this.tasks=[],this.last_added_task=[],this.is_idle=function(){return this.timer===!1},this.work=function(){if(a.tasks.length>0){var c=a.tasks.shift();b.render(c),a.timer=setTimeout(function(){a.work()},400)}else clearTimeout(a.timer),a.timer=!1},this.add_task=function(a){var b=[];b=_.pluck(_.where(this.last_added_task,{is_old:!1}),"message_content").length<a.length?_.map(a,function(a){return{message_content:a,is_old:!1}}):_.map(_.where(this.last_added_task,{is_old:!1}),function(b){return{message_content:b.message_content,is_old:!1===_.contains(a,b.message_content)}}),this.last_added_task=b,this.tasks.push(b),_.where(b,{is_old:!0}).length===b.length&&this.tasks.push([])}};this.worker=new c},render:function(a){var b=this;0===a.length?(c.console_log("debug:views","\nHiding composite status view..."),this.$el.removeClass("visible"),setTimeout(function(){b.$el.removeClass("active")},200),this.is_active=!1):(c.console_log("debug:views","\nUpdating composite status view..."),this.$el_content.html(this.template(a)),!1===this.is_active?(this.$el.addClass("active"),setTimeout(function(){b.$el.addClass("visible")},5),this.is_active=!0):setTimeout(function(){b.$el.find(".message:not(.current)").addClass("old")},100))},status_changed:function(){var a=this.model.get("status_messages");a.length>0?this.worker.add_task(_.pluck(a,"message_content")):this.worker.add_task([]),this.worker.is_idle()&&this.worker.work()}}),e=new d(a);return e},this.Composite_Validation_View=function(a){var d=b.View.extend({render_timer:!1,is_in_widget:!1,template:!1,initialize:function(a){this.template=wp.template("wc_cp_validation_message"),this.is_in_widget=a.is_in_widget,c.actions.add_action("composite_validation_message_changed",this.render,100,this)},render:function(){var a=this,b=this.model;c.console_log("debug:views","\nScheduled update of composite validation view"+(this.is_in_widget?" (widget #"+this.is_in_widget+")":"")+"."),clearTimeout(a.render_timer),a.render_timer=setTimeout(function(){a.render_task(b)},10)},render_task:function(a){c.console_log("debug:views","\nUpdating composite validation view"+(this.is_in_widget?" (widget #"+this.is_in_widget+")":"")+"...");var b=a.get("validation_messages");!1===a.get("passes_validation")&&b.length>0?(this.$el.html(this.template(b)),this.$el.removeClass("inactive").slideDown(200)):this.$el.addClass("inactive").slideUp(200)}}),e=new d(a);return e},this.Composite_Price_View=function(a){var d=b.View.extend({render_timer:!1,is_in_widget:!1,$addons_totals:!1,suffix:"",suffix_contains_price_incl:!1,suffix_contains_price_excl:!1,refreshing_addons_totals:!1,initialize:function(a){if(this.is_in_widget=a.is_in_widget,!this.is_in_widget){var b=c.$composite_data.find("#product-addons-total");b.length>0&&(this.$addons_totals=b,c.actions.add_action("composite_totals_changed",this.update_addons_totals,100,this),c.$composite_data.on("updated_addons",{view:this},this.updated_addons_handler),this.$el.after(b))}""!==wc_composite_params.price_display_suffix&&(this.suffix=' <small class="woocommerce-price-suffix">'+wc_composite_params.price_display_suffix+"</small>",this.suffix_contains_price_incl=wc_composite_params.price_display_suffix.indexOf("{price_including_tax}")>-1,this.suffix_contains_price_excl=wc_composite_params.price_display_suffix.indexOf("{price_excluding_tax}")>-1),c.actions.add_action("composite_totals_changed",this.render,100,this),c.actions.add_action("composite_validation_message_changed",this.render,100,this)},updated_addons_handler:function(a){var b=a.data.view;if(!1===b.refreshing_addons_totals&&b.model.get("passes_validation")){var d=b.model.get("totals"),e=0;b.refreshing_addons_totals=!0,b.$addons_totals.data("price",d.price),b.$addons_totals.data("raw-price",d.price),"yes"===wc_composite_params.calc_taxes&&("incl"===wc_composite_params.tax_display_shop?("yes"===wc_composite_params.prices_include_tax&&(e=b.$addons_totals.data("addons-price")*(1-1/b.model.price_data.base_price_tax)),b.$addons_totals.data("raw-price",d.price_excl_tax-e),b.$addons_totals.data("tax-mode","excl")):("no"===wc_composite_params.prices_include_tax&&(e=b.$addons_totals.data("addons-price")*(1-b.model.price_data.base_price_tax)),b.$addons_totals.data("raw-price",d.price_incl_tax-e),b.$addons_totals.data("tax-mode","incl"))),c.$composite_data.trigger("woocommerce-product-addons-update"),b.refreshing_addons_totals=!1}},update_addons_totals:function(){!1!==this.$addons_totals&&(this.$addons_totals.data("price",0),this.$addons_totals.data("raw-price",0),c.$composite_data.trigger("woocommerce-product-addons-update"))},get_price_html:function(a){var b=this.model,d="undefined"==typeof a?b.price_data:a,e="undefined"==typeof a?b.get("totals"):a.totals,f="";if(0===e.price&&"yes"===d.show_free_string)f='<p class="price"><span class="total">'+wc_composite_params.i18n_total+"</span>"+wc_composite_params.i18n_free+"</p>";else{var g=wc_cp_woocommerce_number_format(wc_cp_number_format(e.price)),h=wc_cp_woocommerce_number_format(wc_cp_number_format(e.regular_price)),i="",j="",k="";""!==this.suffix&&(i=this.suffix,this.suffix_contains_price_incl&&(j='<span class="amount">'+wc_cp_woocommerce_number_format(wc_cp_number_format(d.total_incl_tax))+"</span>",i=i.replace("{price_including_tax}",j)),this.suffix_contains_price_excl&&(k='<span class="amount">'+wc_cp_woocommerce_number_format(wc_cp_number_format(d.total_excl_tax))+"</span>",i=i.replace("{price_excluding_tax}",k))),f=e.regular_price>e.price?'<p class="price"><span class="total">'+wc_composite_params.i18n_total+"</span><del>"+h+"</del> <ins>"+g+"</ins>"+i+"</p>":'<p class="price"><span class="total">'+wc_composite_params.i18n_total+"</span>"+g+i+"</p>"}return c.filters.apply_filters("composite_price_html",[f,this,a])},render:function(){var a=this,b=this.model;c.console_log("debug:views","\nScheduled update of composite price view"+(this.is_in_widget?" (widget #"+this.is_in_widget+")":"")+"."),clearTimeout(a.render_timer),a.render_timer=setTimeout(function(){a.render_task(b)},10)},render_task:function(a){var b;c.console_log("debug:views","\nUpdating composite price view"+(this.is_in_widget?" (widget #"+this.is_in_widget+")":"")+"..."),!a.get("passes_validation")||a.price_data.total===a.price_data.base_display_price&&"yes"!==a.price_data.has_price_range?this.$el.addClass("inactive").slideUp(200):(b=this.get_price_html(),this.$el.html(b),this.$el.removeClass("inactive").slideDown(200))}}),e=new d(a);return e},this.Composite_Availability_View=function(d){var e=b.View.extend({$composite_stock_status:!1,is_in_widget:!1,render_timer:!1,initialize:function(a){this.is_in_widget=a.is_in_widget,c.$composite_data.find(".composite_wrap p.stock").length>0&&(this.$composite_stock_status=c.$composite_data.find(".composite_wrap p.stock").clone()),c.actions.add_action("composite_availability_message_changed",this.render,100,this)},render:function(){var a=this,b=this.model;c.console_log("debug:views","\nScheduled update of composite availability view"+(this.is_in_widget?" (widget #"+this.is_in_widget+")":"")+"."),clearTimeout(a.render_timer),a.render_timer=setTimeout(function(){a.render_task(b)},10)},render_task:function(a){c.console_log("debug:views","\nUpdating composite availability view"+(this.is_in_widget?" (widget #"+this.is_in_widget+")":"")+"...");var b=this.get_insufficient_stock_components();if(b.length>0){var d=wc_composite_params.i18n_insufficient_stock.replace("%s",wc_cp_join(_.map(b,function(a){return c.api.get_step_title(a)})));this.$el.html(d).slideDown(200)}else!1!==this.$composite_stock_status?this.$el.html(this.$composite_stock_status).slideDown(200):this.$el.slideUp(200)},get_insufficient_stock_components:function(){var b=[];return a.each(c.get_components(),function(a,c){c.step_validation_model.get("is_in_stock")||b.push(c.component_id)}),b}}),f=new e(d);return f},this.Composite_Add_To_Cart_Button_View=function(d){var e=b.View.extend({render_timer:!1,is_in_widget:!1,$el_button:!1,$qty:!1,widget_qty_synced:!1,initialize:function(b){this.is_in_widget=b.is_in_widget,this.$el_button=b.$el_button,this.$el_qty=this.$el.find(".quantity input.qty"),c.actions.add_action("composite_availability_status_changed",this.render,100,this),c.actions.add_action("composite_validation_status_changed",this.render,100,this),this.is_in_widget||this.$el_button.on("click",function(){a.each(c.get_steps(),function(b,c){c.$el.find("select, input").each(function(){a(this).prop("disabled",!1)}),!1===c.step_visibility_model.get("is_visible")&&c.is_component()&&c.$component_options_select.val("")})}),this.is_in_widget&&(this.$el_button.on("click",function(){c.composite_add_to_cart_button_view.$el_button.trigger("click")}),this.$el_qty.on("change",{view:this},function(a){var b=a.data.view;b.widget_qty_synced||(c.console_log("debug:views","\nCopying widget #"+b.is_in_widget+" quantity value into composite add-to-cart quantity field..."),b.widget_qty_synced=!0,c.composite_add_to_cart_button_view.$el_qty.val(b.$el_qty.val()).change(),b.widget_qty_synced=!1)}),c.composite_add_to_cart_button_view.$el_qty.on("change",{view:this},function(a){var b=a.data.view;c.console_log("debug:views","\nCopying composite add-to-cart quantity value into widget #"+b.is_in_widget+" quantity field..."),b.$el_qty.val(c.composite_add_to_cart_button_view.$el_qty.val()).change()}))},render:function(){var a=this,b=this.model;c.console_log("debug:views","\nScheduled update of composite add-to-cart button view"+(this.is_in_widget?" (widget #"+this.is_in_widget+")":"")+"."),clearTimeout(a.render_timer),a.render_timer=setTimeout(function(){a.render_task(b)},10)},render_task:function(a){c.console_log("debug:views","\nUpdating composite add-to-cart button view"+(this.is_in_widget?" (widget #"+this.is_in_widget+")":"")+"..."),a.get("passes_validation")&&a.get("is_in_stock")?"new"===c.settings.button_behaviour?this.$el_button.prop("disabled",!1).removeClass("disabled"):this.$el.slideDown(200):"new"===c.settings.button_behaviour?this.$el_button.prop("disabled",!0).addClass("disabled"):this.$el.slideUp(200)}}),f=new e(d);return f},this.Composite_Pagination_View=function(d){var e=b.View.extend({template:!1,template_html:"",initialize:function(){this.template=wp.template("wc_cp_composite_pagination"),c.actions.add_action("step_access_changed",this.step_access_changed_handler,100,this),c.actions.add_action("step_visibility_changed",this.step_visibility_changed_handler,100,this),c.actions.add_action("active_step_changed",this.active_step_changed_handler,100,this),this.$el.on("click",".pagination_element a",this.clicked_pagination_element)},step_visibility_changed_handler:function(){this.render()},step_access_changed_handler:function(){this.render()},active_step_changed_handler:function(){this.render()},clicked_pagination_element:function(){if(a(this).blur(),c.has_transition_lock)return!1;if(a(this).hasClass("inactive"))return!1;var b=a(this).closest(".pagination_element").data("item_id"),d=c.get_step(b);return d&&c.navigate_to_step(d),!1},render:function(){var b=[];if(!c.is_initialized)return!1;c.console_log("debug:views","\nRendering pagination view elements..."),a.each(c.get_steps(),function(a,c){if(c.is_visible()){var d={element_id:c.step_id,element_title:c.get_title(),element_class:"",element_state_class:""};c.is_current()?(d.element_state_class="inactive",d.element_class="pagination_element_current"):c.is_locked()&&(d.element_state_class="inactive"),b.push(d)}}),b=c.filters.apply_filters("composite_pagination_view_data",[b]);var d=this.template(b);d!==this.template_html?(this.template_html=d,this.$el.html(d)):c.console_log("debug:views","...skipped!")}}),f=new e(d);return f},this.Composite_Summary_View=function(d){var e=b.View.extend({update_content_timers:{},view_elements:{},is_in_widget:!1,template:!1,initialize:function(b){var d=this;this.template=wp.template("wc_cp_summary_element_content"),this.is_in_widget=b.is_in_widget,a.each(c.get_steps(),function(a,b){b.step_validation_model.on("change:passes_validation",function(){d.render_element_content(b)})}),a.each(c.get_components(),function(a,b){d.view_elements[b.component_id]={$summary_element:d.$el.find(".summary_element_"+b.component_id),$summary_element_link:d.$el.find(".summary_element_"+b.component_id+" .summary_element_link"),$summary_element_wrapper:d.$el.find(".summary_element_"+b.component_id+" .summary_element_wrapper"),$summary_element_inner:d.$el.find(".summary_element_"+b.component_id+" .summary_element_wrapper_inner"),template_html:""}}),c.actions.add_action("step_access_changed",this.step_access_changed_handler,100,this),c.actions.add_action("step_visibility_changed",this.step_visibility_changed_handler,100,this),c.actions.add_action("component_quantity_changed",this.quantity_changed_handler,100,this),c.actions.add_action("component_selection_changed",this.selection_changed_handler,100,this),c.actions.add_action("component_selection_content_changed",this.selection_changed_handler,100,this),c.actions.add_action("component_totals_changed",this.component_totals_changed_handler,100,this),"single"!==c.settings.layout&&c.actions.add_action("active_step_changed",this.active_step_changed_handler,100,this),this.$el.on("click",".summary_element_link",this.clicked_summary_element),this.$el.on("click","a.summary_element_tap",function(){return a(this).closest(".summary_element_link").trigger("click"),!1})},step_access_changed_handler:function(a){this.render_element_state(a)},step_visibility_changed_handler:function(a){this.render_element_visibility(a),this.render_indexes(a.step_index)},active_step_changed_handler:function(){this.render_state()},selection_changed_handler:function(a){this.render_element_content(a)},quantity_changed_handler:function(a){this.render_element_content(a)},component_totals_changed_handler:function(a){this.render_element_content(a)},clicked_summary_element:function(){if(c.has_transition_lock)return!1;if(a(this).hasClass("disabled"))return!1;var b=a(this).closest(".summary_element").data("item_id"),d=c.get_step(b);return d!==!1&&(d.is_current()&&"single"!==c.settings.layout||c.navigate_to_step(d),!1)},render_indexes:function(b){if(!c.is_initialized)return!1;b="undefined"==typeof b?0:b;var d=parseInt(c.$composite_summary.data("columns")),e=0,f=this;c.console_log("debug:views","\nUpdating summary view element indexes..."),a.each(c.get_steps(),function(a,g){if("undefined"==typeof f.view_elements[g.step_id])return!0;if(g.step_index<b)return g.is_visible()&&e++,!0;if(!1===f.is_in_widget){var h="";g.is_visible()&&(e++,(e-1)%d!=0&&1!=d||(h+=" first"),e%d==0&&(h+=" last")),f.view_elements[g.step_id].$summary_element.removeClass("first last").addClass(h)}c.debug_tab_count=c.debug_tab_count+2,f.render_element_content(g),c.debug_tab_count=c.debug_tab_count-2})},render_visibility:function(){if(!c.is_initialized)return!1;var b=this;c.console_log("debug:views","\nRendering summary view element visibility"+(this.is_in_widget?" (widget #"+this.is_in_widget+")":"")+"..."),c.debug_tab_count=c.debug_tab_count+2,a.each(c.get_steps(),function(a,c){b.render_element_visibility(c)}),c.debug_tab_count=c.debug_tab_count-2},render_state:function(){if(!c.is_initialized)return!1;var b=this;c.console_log("debug:views","\nRendering summary view element states"+(this.is_in_widget?" (widget #"+this.is_in_widget+")":"")+"..."),c.debug_tab_count=c.debug_tab_count+2,a.each(c.get_steps(),function(a,c){b.render_element_state(c)}),c.debug_tab_count=c.debug_tab_count-2},render_content:function(){var b=this;c.console_log("debug:views","\nRendering summary view element contents"+(this.is_in_widget?" (widget #"+this.is_in_widget+")":"")+"..."),c.debug_tab_count=c.debug_tab_count+2,a.each(c.get_steps(),function(a,c){b.render_element_content(c)}),c.debug_tab_count=c.debug_tab_count-2},render:function(){c.console_log("debug:views","\nRendering summary view elements"+(this.is_in_widget?" (widget #"+this.is_in_widget+")":"")+"..."),c.debug_tab_count=c.debug_tab_count+2,this.render_visibility(),this.render_state(),this.render_indexes(),this.render_content(),c.debug_tab_count=c.debug_tab_count-2},get_element_price_html:function(a){var b=c.data_model.price_data,d="";if(a.is_component()&&a.is_subtotal_visible()){var e=a,f=e.component_id,g="variable"===e.get_selected_product_type()?e.get_selected_variation(!1):e.get_selected_product(!1),h=e.get_selected_quantity();if(g>0&&h>0){var i=c.data_model.get("component_"+f+"_totals");if("no"===b.is_priced_individually[f]&&0===i.price&&0===i.regular_price)d="";else{var j=wc_cp_woocommerce_number_format(wc_cp_number_format(i.price)),k=wc_cp_woocommerce_number_format(wc_cp_number_format(i.regular_price));d=i.regular_price>i.price?'<span class="price summary_element_content"><del>'+k+"</del> <ins>"+j+"</ins></span>":'<span class="price summary_element_content">'+j+"</span>"}}}return d},render_element_content:function(a){if(!c.is_initialized)return!1;var b=this;return"undefined"!=typeof this.view_elements[a.step_id]&&(c.console_log("debug:views",'\nScheduled update of "'+a.get_title()+'" summary view element content'+(this.is_in_widget?" (widget #"+this.is_in_widget+")":"")+"."),"undefined"!=typeof this.update_content_timers[a.step_index]&&clearTimeout(b.update_content_timers[a.step_index]),void(this.update_content_timers[a.step_index]=setTimeout(function(){b.render_element_content_task(a)},50)))},render_element_content_task:function(a){if(c.console_log("debug:views",'\nRendering "'+a.get_title()+'" summary view element content'+(this.is_in_widget?" (widget #"+this.is_in_widget+")":"")+"..."),a.is_component()){var b=a,d=b.component_id,e=this.view_elements[d].$summary_element_wrapper,f=this.view_elements[d].$summary_element_inner,g=this.view_elements[d].template_html,h={
element_index:a.get_title_index(),element_title:a.get_title(),element_selection_title:"",element_action:"",element_image_src:"",element_image_srcset:"",element_image_sizes:"",element_image_title:"",element_price:""},i="",j="",k=!1,l=0,m=this.$el.is(":visible");m&&(l=f.outerHeight(!0),e.css("height",l)),i=b.get_selected_product_title(!0,!1),!1===this.is_in_widget&&(j=i&&b.passes_validation()?b.is_static()?wc_composite_params.i18n_summary_static_component:wc_composite_params.i18n_summary_configured_component:wc_composite_params.i18n_summary_empty_component),(a.is_current()&&m||this.is_in_widget)&&(j=""),h.element_selection_title=i,h.element_action=j,k=b.get_selected_product_image_data(!1),!1===k&&(k=b.get_placeholder_image_data()),k&&(h.element_image_src=k.image_src,h.element_image_srcset=k.image_srcset?k.image_srcset:"",h.element_image_sizes=k.image_sizes?k.image_sizes:"",h.element_image_title=k.image_title),h.element_price=this.get_element_price_html(a),h=c.filters.apply_filters("component_summary_element_content_data",[h,b,this]);var n=this.template(h);n!==g?(this.view_elements[d].template_html=n,f.html(n)):c.console_log("debug:views","...skipped!"),b.passes_validation()?e.addClass("configured"):e.removeClass("configured"),c.actions.do_action("component_summary_content_updated",[b,this]);var o=0,p=function(){if(k.image_src){var a=f.find(".summary_element_image img");0===a.height()&&o<1e3?(o+=50,setTimeout(function(){p()},50)):q()}else q()},q=function(){var a=f.outerHeight(!0),b=!1;Math.abs(a-l)>1?b=!0:e.css("height","auto"),b&&(c.console_log("debug:events","Starting updated element content animation..."),e.animate({height:a},{duration:200,queue:!1,always:function(){c.console_log("debug:events","Ended updated element content animation."),e.css({height:"auto"})}}))};m&&setTimeout(function(){p()},10)}},render_element_visibility:function(a){if(!c.is_initialized)return!1;if("undefined"==typeof this.view_elements[a.step_id])return!1;var b=this.view_elements[a.step_id].$summary_element;c.console_log("debug:views",'\nUpdating "'+a.get_title()+'" summary view element visibility'+(this.is_in_widget?" (widget #"+this.is_in_widget+")":"")+"..."),!1===a.is_visible()?b.addClass("hidden"):b.removeClass("hidden")},render_element_state:function(a){if(!c.is_initialized)return!1;if("undefined"==typeof this.view_elements[a.step_id])return!1;var b=this.view_elements[a.step_id].$summary_element,d=this.view_elements[a.step_id].$summary_element_link;c.console_log("debug:views",'\nUpdating "'+a.get_title()+'" summary view element state'+(this.is_in_widget?" (widget #"+this.is_in_widget+")":"")+"..."),a.is_current()?(d.removeClass("disabled"),"single"!==c.settings.layout&&d.addClass("selected"),!1===c.get_step("review")&&b.find(".summary_element_selection_prompt").slideUp(200)):(a.is_locked()?(d.removeClass("selected"),d.addClass("disabled")):(d.removeClass("disabled"),d.removeClass("selected")),b.find(".summary_element_selection_prompt").slideDown(200))}}),f=new e(d);return f},this.Composite_Navigation_View=function(d){var e=b.View.extend({render_timer:!1,render_movable_timer:!1,updated_buttons_data:{},navi_in_step:!1,template:!1,$el_progressive:c.$composite_form.find(".composite_navigation.progressive"),$el_paged_top:c.$composite_navigation_top,$el_paged_bottom:c.$composite_navigation_bottom,$el_paged_movable:c.$composite_navigation_movable,initialize:function(){this.template=wp.template("wc_cp_composite_navigation"),c.actions.add_action("component_selection_changed",this.selection_changed_handler,110,this),c.actions.add_action("component_selection_content_changed",this.selection_content_changed_handler,100,this),c.actions.add_action("active_step_transition_start",this.active_step_transition_start_handler,110,this),c.actions.add_action("options_state_rendered",this.options_state_rendered_handler,20,this),this.$el.on("click",".page_button",this.clicked_navigation_button)},selection_content_changed_handler:function(){return!!c.is_initialized&&void this.render_change()},selection_changed_handler:function(a){if(!c.is_initialized)return!1;if(a.is_current()&&a.autotransition()&&a.passes_validation()&&!a.component_selection_view.resetting_product){var b=c.get_next_step();return b&&b.is_component()&&b.component_options_view.is_updating()?c.actions.add_action("component_options_refreshed_"+b.step_id,this.autotransition,10,this):c.show_next_step(),!1}this.render_change()},autotransition:function(){c.show_next_step(),c.actions.remove_action("component_options_refreshed_"+c.get_current_step().step_id,this.autotransition)},active_step_transition_start_handler:function(){var a=this;clearTimeout(a.render_timer),a.render("transition")},options_state_rendered_handler:function(a,b){return!!c.is_initialized&&void(a.is_current()&&_.contains(b,"thumbnails")&&a.component_selection_view.is_relocated()&&this.render_movable())},clicked_navigation_button:function(){return a(this).blur(),!a(this).hasClass("inactive")&&(!c.has_transition_lock&&(a(this).hasClass("next")?c.get_next_step()?c.show_next_step():wc_cp_scroll_viewport(c.$composite_form.find(".scroll_final_step"),{partial:!1,duration:250,queue:!1}):c.show_previous_step(),!1))},update_buttons:function(){var a=this,b={prev_btn:{btn_classes:"",btn_text:""},next_btn:{btn_classes:"",btn_text:""}};!1!==this.updated_buttons_data.button_next_html&&(b.next_btn.btn_text=this.updated_buttons_data.button_next_html),!1!==this.updated_buttons_data.button_prev_html&&(b.prev_btn.btn_text=this.updated_buttons_data.button_prev_html),!1===this.updated_buttons_data.button_next_visible&&(b.next_btn.btn_classes="invisible"),!1===this.updated_buttons_data.button_prev_visible&&(b.prev_btn.btn_classes="invisible"),!1===this.updated_buttons_data.button_next_active&&(b.next_btn.btn_classes+=" inactive"),this.$el.html(a.template(b))},render_change:function(){var a=this;c.console_log("debug:views","\nScheduling navigation UI update..."),clearTimeout(a.render_timer),a.render_timer=setTimeout(function(){a.render("change")},40)},render:function(a){c.console_log("debug:views","\nRendering navigation UI...");var b=c.get_current_step(),d=c.get_next_step(),e=c.get_previous_step(),f=this;if(this.updated_buttons_data={button_next_html:!1,button_prev_html:!1,button_next_visible:!1,button_prev_visible:!1,button_next_active:!1},"transition"===a&&"paged"===c.settings.layout&&"componentized"===c.settings.layout_variation&&(b.is_review()?this.$el_paged_bottom.hide():this.$el_paged_bottom.show()),b.is_component()&&(d&&"componentized"!==c.settings.layout_variation?(this.updated_buttons_data.button_next_html=wc_composite_params.i18n_next_step.replace("%s",d.get_title()),this.updated_buttons_data.button_next_visible=!0):d&&"paged"===c.settings.layout&&(this.updated_buttons_data.button_next_html=wc_composite_params.i18n_final_step,this.updated_buttons_data.button_next_visible=!0)),b.passes_validation()||"componentized"===c.settings.layout_variation&&b.is_component())d&&(this.updated_buttons_data.button_next_active=!0),e&&"paged"===c.settings.layout&&e.is_component()?(this.updated_buttons_data.button_prev_html=wc_composite_params.i18n_previous_step.replace("%s",e.get_title()),this.updated_buttons_data.button_prev_visible=!0):this.updated_buttons_data.button_prev_html="";else if(e&&e.is_component()){var g=e.get_selected_product();(g>0||"0"===g||""===g&&e.is_optional())&&"paged"===c.settings.layout&&(this.updated_buttons_data.button_prev_html=wc_composite_params.i18n_previous_step.replace("%s",e.get_title()),this.updated_buttons_data.button_prev_visible=!0)}if("progressive"===c.settings.layout){var h=f.$el_progressive;if(f.navi_in_step!==b.step_id)h.slideUp({duration:200,always:function(){f.update_buttons(),h.appendTo(b.$inner_el).hide(),f.navi_in_step=b.step_id,setTimeout(function(){var a=!1;b.$el.hasClass("last")||b.passes_validation()&&!d.has_toggle()&&(a=!0),a&&h.slideDown({duration:200,queue:!1})},200)}});else{f.update_buttons();var i=!1;b.$el.hasClass("last")||b.passes_validation()&&!d.has_toggle()&&(i=!0),i?h.slideDown(200):h.slideUp(200)}}else"paged"===c.settings.layout&&(f.navi_in_step!==b.step_id&&(b.$el.prepend(f.$el_paged_top),b.$el.append(f.$el_paged_bottom),f.navi_in_step=b.step_id),f.update_buttons(),f.render_movable())},render_movable:function(){var a=this;c.console_log("debug:views","\nScheduling movable navigation visibility update..."),clearTimeout(a.render_movable_timer),a.render_movable_timer=setTimeout(function(){a.render_movable_task()},10)},render_movable_task:function(){var a=c.get_current_step(),b=this;if(a.is_component()&&a.has_options_style("thumbnails")&&a.get_selected_product()>0){var d=a.$component_content.find(".composite_navigation").length>0,e=!1;if(a.append_results()&&a.component_selection_view.is_relocated()){var f=a.$component_options.find(".component_option_thumbnail_container").not(".hidden"),g=a.$component_options.find(".component_option_thumbnail.selected").closest(".component_option_thumbnail_container"),h=f.index(g)+1,i=c.$composite_form.width()>wc_composite_params.small_width_threshold&&!1===c.$composite_form.hasClass("legacy_width")?parseInt(a.$component_thumbnail_options.data("columns")):1;Math.ceil(h/i)===Math.ceil(f.length/i)&&(e=!0)}d||e||(b.$el_paged_movable.appendTo(a.$component_summary),d=!0),d&&(e||a.is_static()?b.$el_paged_movable.addClass("hidden"):b.$el_paged_movable.removeClass("hidden"))}}}),f=new e(d);return f},this.Composite_Widget_View=function(a){var d=b.View.extend({show_hide_timer:!1,initialize:function(a){this.$el.removeClass("cp-no-js"),this.validation_view=new c.view_classes.Composite_Validation_View({is_in_widget:a.widget_count,el:this.$el.find(".widget_composite_summary_error .composite_message"),model:c.data_model}),this.price_view=new c.view_classes.Composite_Price_View({is_in_widget:a.widget_count,el:this.$el.find(".widget_composite_summary_price .composite_price"),model:c.data_model}),this.availability_view=new c.view_classes.Composite_Availability_View({is_in_widget:a.widget_count,el:this.$el.find(".widget_composite_summary_availability .composite_availability"),model:c.data_model}),this.add_to_cart_button_view=new c.view_classes.Composite_Add_To_Cart_Button_View({is_in_widget:a.widget_count,el:this.$el.find(".widget_composite_summary_button .composite_button"),$el_button:this.$el.find(".widget_composite_summary_button .composite_button .composite_add_to_cart_button"),model:c.data_model}),this.composite_summary_view=new c.view_classes.Composite_Summary_View({is_in_widget:a.widget_count,el:this.$el.find(".widget_composite_summary_elements")}),c.actions.do_action("widget_view_initialized",[a,this]),"paged"===c.settings.layout&&c.actions.add_action("active_step_changed",this.active_step_changed_handler,100,this)},active_step_changed_handler:function(){this.show_hide()},show_hide:function(){var a=this;clearTimeout(a.show_hide_timer),this.show_hide_timer=setTimeout(function(){a.show_hide_task()},20)},show_hide_task:function(){var a=c.get_current_step().is_review();a?(this.$el.slideUp(250),this.$el.animate({opacity:0},{duration:250,queue:!1}),this.$el.addClass("inactive")):this.$el.hasClass("inactive")&&(this.$el.removeClass("inactive"),this.$el.slideDown(250),this.$el.animate({opacity:1},{duration:250,queue:!1}))}}),e=new d(a);return e},this.Step_Validation_View=function(a,d){var e=a,f=b.View.extend({render_timer:!1,render_html:!1,template:!1,event_type:"",initialize:function(){var a=this;this.template=wp.template("wc_cp_validation_message"),this.listenTo(this.model,"change:component_messages",function(){return!(!e.is_current()||"undefined"==typeof e.$component_message)&&(!e.component_selection_view.resetting_product&&(c.console_log("debug:views",'\nScheduling "'+e.get_title()+'" validation message update...'),clearTimeout(a.render_timer),void(a.render_timer=setTimeout(function(){a.prepare_render("change"),a.render()},10))))}),"single"!==c.settings.layout&&c.actions.add_action("active_step_changed_"+e.step_id,this.active_step_changed_handler,100,this),"single"!==c.settings.layout&&c.actions.add_action("active_step_transition_end_"+e.step_id,this.active_step_transition_end_handler,100,this)},active_step_changed_handler:function(){return!(!e.is_current()||"undefined"==typeof e.$component_message)&&void this.prepare_render("transition")},active_step_transition_end_handler:function(){return!(!e.is_current()||"undefined"==typeof e.$component_message)&&(clearTimeout(this.render_timer),void this.render())},prepare_render:function(a){this.event_type=""===this.event_type?a:this.event_type;var b;if(c.console_log("debug:views",'\nPreparing "'+e.get_title()+'" validation message update...'),this.render_html=!1,b=!(e.passes_validation()||"componentized"===c.settings.layout_variation&&e.is_component()),b&&(!e.$el.hasClass("last")||!e.$el.hasClass("progressive"))){var d=e.get_validation_messages();d.length>0&&(this.render_html=this.template(d))}"transition"===this.event_type&&!1===this.render_html&&("progressive"===c.settings.layout?e.has_toggle()&&e.$component_message.hide():"paged"===c.settings.layout&&e.$component_message.hide())},render:function(){var a=this;if(c.console_log("debug:views",'\nUpdating "'+e.get_title()+'" validation message...'),!1!==this.render_html&&e.$component_message.html(this.render_html),"progressive"===c.settings.layout)"transition"===this.event_type?setTimeout(function(){!1===a.render_html?e.$component_message.slideUp(200):e.$component_message.slideDown(200)},200):!1===this.render_html?e.$component_message.slideUp(200):e.$component_message.slideDown(200);else if("paged"===c.settings.layout){var b=0;e.is_component()&&e.$component_content.hasClass("updating")&&!1!==this.render_html&&(b=600),e.is_component()&&e.$component_content.hasClass("relocating")&&(e.$component_message.hide(),b=600),setTimeout(function(){!1===a.render_html?e.$component_message.slideUp(200):e.$component_message.slideDown(200)},b)}this.event_type=""}}),g=new f(d);return g},this.Component_Pagination_View=function(d,e){var f=d,g=b.View.extend({template:!1,initialize:function(){this.template=wp.template("wc_cp_options_pagination"),this.listenTo(this.model,"change:page change:pages",this.render),f.$el.on("click",".component_pagination a.component_pagination_element",{view:this},this.load_page),f.$el.on("click",".component_pagination a.component_options_load_more",{view:this},this.load_more)},load_page:function(){a(this).blur();var b=parseInt(a(this).data("page_num"));return b>0&&(c.block(f.$component_options),f.component_options_view.$blocked_element=f.$component_options,f.$component_options.find(".blockUI").addClass("bottom"),f.component_options_view.update_options({page:b},"reload")),!1},load_more:function(){a(this).blur();var b=parseInt(f.component_options_model.get("page")),d=parseInt(f.component_options_model.get("pages"));return b>0&&b<d&&(c.block(f.$component_options),f.component_options_view.$blocked_element=f.$component_options,f.$component_options.find(".blockUI").addClass("bottom"),f.component_options_view.update_options({page:b+1},"append")),!1},render:function(){if(!c.is_initialized)return!1;var a=this.model,b={page:a.get("page"),pages:a.get("pages"),range_mid:f.get_pagination_range(),range_end:f.get_pagination_range("end"),pages_in_range:2*(f.get_pagination_range()+f.get_pagination_range("end"))+1,i18n_page_of_pages:wc_composite_params.i18n_page_of_pages.replace("%p",a.get("page")).replace("%t",a.get("pages"))};c.console_log("debug:views",'\nRendering "'+f.get_title()+'" options pagination...'),f.append_results()?b.page<b.pages?f.$component_pagination.slideDown(200):f.$component_pagination.slideUp(200):this.$el.html(this.template(b))}}),h=new g(e);return h},this.Component_Options_View=function(d,e){var f=d,g=b.View.extend({templates:{dropdown:!1,thumbnails:!1,radios:!1},update_action:"",load_height:0,$blocked_element:!1,append_results_retry_count:0,changes:{dropdown:{changed:!1,to:""},thumbnails:{changed:!1,to:""},radios:{changed:!1,to:""},variations:{changed:!1,to:[]}},initialize:function(){this.templates.dropdown=wp.template("wc_cp_options_dropdown"),this.templates.thumbnails=wp.template("wc_cp_options_thumbnails"),this.templates.radios=wp.template("wc_cp_options_radio_buttons"),f.$el.on("click",".component_filter_option a",{view:this},this.activate_filter),f.$el.on("click",".component_filters a.reset_component_filter",{view:this},this.reset_filter),f.$el.on("click",".component_filters a.reset_component_filters",{view:this},this.reset_filters),f.$el.on("change",".component_ordering select",{view:this},this.order_by),f.$el.on("click",".component_filter_title label",{view:this},this.toggle_filter),"progressive"===c.settings.layout&&f.$el.on("click",".block_component_selections_inner",{view:this},this.clicked_blocked_area),f.has_options_style("thumbnails")&&(f.$el.on("click",".component_option_thumbnail",{view:this},this.clicked_thumbnail),f.$el.on("click","a.component_option_thumbnail_tap",{view:this},this.clicked_thumbnail_tap)),f.has_options_style("radios")&&(f.$el.on("change",".component_option_radio_buttons input",{view:this},this.clicked_radio),f.$el.on("click","a.component_option_radio_button_tap",{view:this},this.clicked_radio_tap)),c.actions.add_action("component_options_loaded_"+f.step_id,this.updated_options,10,this),c.actions.add_action("options_state_changed_"+f.step_id,this.render,10,this),this.listenTo(this.model,"change:options_in_scenarios",this.options_in_scenarios_changed)},options_in_scenarios_changed:function(){this.model.reload_options_on_scenarios_change()&&(c.block(f.$component_options),this.$blocked_element=f.$component_options,c.data_model.add_status_message(f.component_id,wc_composite_params.i18n_loading_options.replace("%s",f.get_title())),this.update_options({page:1},"reload"))},clicked_blocked_area:function(){return c.navigate_to_step(f),!1},clicked_thumbnail_tap:function(){return a(this).closest(".component_option_thumbnail").trigger("click"),!1},clicked_thumbnail:function(){if(a(this).blur(),f.$el.hasClass("disabled")||a(this).hasClass("disabled"))return!0;if(!a(this).hasClass("selected")){var b=a(this).data("val");f.$component_options_select.val(b).change()}},clicked_radio_tap:function(){return a(this).closest(".component_option_radio_button").find("input").trigger("click"),!1},clicked_radio:function(){var b=a(this).closest(".component_option_radio_button");if(f.$el.hasClass("disabled")||b.hasClass("disabled"))return!0;if(!b.hasClass("selected")){var c=a(this).val();f.$component_options_select.val(c).change()}},toggle_filter:function(){a(this).blur();var b=a(this).closest(".component_filter"),c=b.find(".component_filter_content");return wc_cp_toggle_element(b,c),!1},activate_filter:function(b){if(a(this).blur(),f.$el.hasClass("disabled"))return!1;var d=b.data.view,e=a(this).closest(".component_filter_option");return e.hasClass("selected")?e.removeClass("selected"):e.addClass("selected"),d.update_filters_ui(),c.block(f.$component_filters),d.$blocked_element=f.$component_filters,d.update_options({page:1,filters:f.find_active_filters()},"reload"),!1},reset_filter:function(b){a(this).blur();var d=b.data.view,e=a(this).closest(".component_filter").find(".component_filter_option.selected");return 0!=e.length&&(e.removeClass("selected"),d.update_filters_ui(),c.block(f.$component_filters),d.$blocked_element=f.$component_filters,d.update_options({page:1,filters:f.find_active_filters()},"reload"),!1)},reset_filters:function(b){a(this).blur();var d=b.data.view,e=f.$component_filters.find(".component_filter_option.selected");return 0!=e.length&&(e.removeClass("selected"),d.update_filters_ui(),c.block(f.$component_filters),d.$blocked_element=f.$component_filters,d.update_options({page:1,filters:f.find_active_filters()},"reload"),!1)},update_filters_ui:function(){var b=f.$component_filters.find(".component_filter"),c=!0;return 0!=b.length&&(b.each(function(){0==a(this).find(".component_filter_option.selected").length?a(this).removeClass("active"):(a(this).addClass("active"),c=!1)}),void(c?f.$component_filters.removeClass("filtered"):f.$component_filters.addClass("filtered")))},order_by:function(b){var d=b.data.view,e=a(this).val();return a(this).blur(),c.block(f.$component_options),d.$blocked_element=f.$component_options,d.update_options({page:1,orderby:e},"reload"),!1},render:function(b){if(!c.is_initialized)return!1;b="undefined"!=typeof b&&b,c.console_log("debug:views",'\nRendering "'+f.get_title()+'" options in view...');var d=f.component_options_model,e=d.get("options_state").active,g=f.get_selected_product(!1),h=a.extend(!0,[],d.available_options_data),i=[];this.changes.dropdown.changed=!1,this.changes.thumbnails.changed=!1,this.changes.radios.changed=!1,this.changes.variations.changed=!1,a.each(h,function(a,b){var c=b.option_id,d=_.contains(e,c);d?h[a].is_disabled=!1:h[a].is_disabled=!0,h[a].is_hidden=h[a].is_disabled&&f.hide_disabled_products(),h[a].is_selected=h[a].option_id===g});var j=a.extend(!0,[],h);a.each(j,function(a,b){j[a].option_dropdown_title=f.has_options_style("dropdowns")?b.option_display_title:b.option_title,j[a].is_selected=h[a].is_selected&&f.is_selected_product_valid()});var k,l=!1,m=!1,n=!1;if(0===e.length?(l=!0,k=wc_composite_params.i18n_no_options):(k=f.is_optional()?wc_composite_params.i18n_no_option.replace("%s",f.get_title()):wc_composite_params.i18n_select_option.replace("%s",f.get_title()),f.maybe_is_optional()?(l=!0,!1===f.is_selected_product_valid()&&(m=!0),!1===f.is_optional()&&(""===g&&(m=!0),n=!0,k=wc_composite_params.i18n_no_option.replace("%s",f.get_title()))):!1===f.is_static()&&f.show_placeholder_option()?l=!0:""===g&&!1===f.show_placeholder_option()?l=!0:!1===f.is_selected_product_valid()&&!1===f.show_placeholder_option()&&(m=!0)),l&&j.unshift({option_id:"",option_dropdown_title:k,is_disabled:n,is_hidden:n&&f.hide_disabled_products(),is_selected:""===g&&!1===m}),m&&(f.$component_options_select.data("has_extra_empty_option",!0),j.unshift({option_id:"",option_dropdown_title:wc_composite_params.i18n_select_option.replace("%s",f.get_title()),is_disabled:!1,is_hidden:!1,is_selected:!1})),this.changes.dropdown.changed=!0,this.changes.dropdown.to=this.templates.dropdown(j),!1===b){if(f.has_options_style("thumbnails")){var o=_.where(h,{is_in_view:!0}),p=parseInt(f.$component_thumbnail_options.data("columns")),q=0;o.length>0&&a.each(o,function(a,b){o[a].outer_classes=b.is_hidden?"hidden":"",o[a].inner_classes=b.is_disabled?"disabled":"",o[a].inner_classes+=b.option_id===g?" selected":"",o[a].inner_classes+=b.is_appended?" appended":"",!1===b.is_hidden&&(q++,(q-1)%p!=0&&1!=p||(o[a].outer_classes+=" first"),q%p==0&&(o[a].outer_classes+=" last"))});var r=this.templates.thumbnails(o);r.replace(/ selected/g,"")!==this.changes.thumbnails.to.replace(/ selected/g,"")?(this.changes.thumbnails.changed=!0,this.changes.thumbnails.to=r):c.console_log("debug:views","...skipped!")}else if(f.has_options_style("radios")){var s=_.where(h,{is_in_view:!0}),t=!1,u=f.maybe_is_optional()&&!1===f.is_optional(),v=u&&f.hide_disabled_products();f.maybe_is_optional()?t=!0:!1===f.is_static()&&f.show_placeholder_option()&&(t=!0,v=!0),t&&s.unshift({option_id:"",option_display_title:wc_composite_params.i18n_no_option.replace("%s",f.get_title()),is_disabled:u,is_hidden:v,is_selected:""===g}),s.length>0&&a.each(s,function(a,b){s[a].outer_classes=b.is_hidden?"hidden":"",s[a].inner_classes=b.is_disabled?"disabled":"",s[a].inner_classes+=b.option_id===g?" selected":"",s[a].option_suffix=""===b.option_id?"0":b.option_id,s[a].option_group_id=f.component_id}),this.changes.radios.changed=!0,this.changes.radios.to=this.templates.radios(s)}if("variable"===f.get_selected_product_type()){for(var w,x=f.get_selected_variation(!1),y=f.$component_data.data("product_variations"),z=[],A=0;A<y.length;A++){var B=y[A].variation_id.toString(),C=_.contains(e,B);if("yes"!==wc_composite_params.is_wc_version_gte_2_3||f.hide_disabled_variations())C?z.push(y[A]):parseInt(x)===parseInt(B)&&(w=a.extend(!0,{},y[A]),w.variation_is_active=!1,z.push(w));else{var D=!1;if(w=a.extend(!0,{},y[A]),!C){w.variation_is_active=!1;for(var E in w.attributes)if(""===w.attributes[E]){D=!0;break}}D||z.push(w)}}this.changes.variations.changed=!_.isEqual(f.$component_summary_content.data("product_variations"),z),this.changes.variations.to=z}}i=_.keys(_.pick(this.changes,function(a){return a.changed})),i.length>0&&(c.actions.do_action("options_state_render",[f,i]),this.changes.dropdown.changed&&f.$component_options_select.html(this.changes.dropdown.to),this.changes.thumbnails.changed&&f.$component_thumbnail_options.html(this.changes.thumbnails.to),this.changes.radios.changed&&f.$component_radio_button_options.html(this.changes.radios.to),this.changes.variations.changed&&(f.$component_summary_content.data("product_variations",this.changes.variations.to),f.$component_summary_content.triggerHandler("reload_product_variations")),c.actions.do_action("options_state_rendered",[f,i]))},update_options:function(a,b){this.update_action=b,"reload"===b&&f.$component_selections.addClass("refresh_component_options"),"undefined"!=typeof f.$component_options.get(0).getBoundingClientRect().height?this.load_height=f.$component_options.get(0).getBoundingClientRect().height:this.load_height=f.$component_options.outerHeight(),f.$component_options.css("height",this.load_height),setTimeout(function(){f.component_options_model.request_options(a,b)},200)},updated_options:function(){if(!1===this.$blocked_element)return!1;if("append"===this.update_action&&f.hide_disabled_products()&&f.$component_thumbnail_options.find(".appended:not(.disabled)").length<f.get_results_per_page()){var b=this.model.get("page")<this.model.get("pages");if(b&&this.append_results_retry_count>10&&!1===window.confirm(wc_composite_params.i18n_reload_threshold_exceeded.replace("%s",f.get_title()))&&(b=!1),b)return this.append_results_retry_count++,this.model.request_options({page:this.model.get("page")+1},"append"),!1;this.append_results_retry_count=0}var c=f.$component_thumbnail_options.find(".component_option_thumbnails_container"),d=c.find(".component_option_thumbnail_container:not(.hidden) img"),e=0,g=this,h=function(){if(d.length>0&&c.is(":visible")){var b=!1;d.each(function(){var c=a(this);if(0===c.height()&&e<1e4)return b=!0,!1}),b?(e+=100,setTimeout(function(){h()},100)):g.animate_options()}else g.animate_options()};setTimeout(function(){h()},10)},animate_options:function(){var a=this,b=f.$component_options_inner.outerHeight(!0),c=!1;Math.abs(b-a.load_height)>1?c=!0:f.$component_options.css("height","auto");var d={};"append"===this.update_action&&(d=f.$component_thumbnail_options.find(".appended"),d.removeClass("appended")),c?("reload"===a.update_action&&f.$component_selections.removeClass("refresh_component_options"),f.$component_options.animate({height:b},{duration:250,queue:!1,always:function(){f.$component_options.css({height:"auto"}),setTimeout(function(){a.unblock()},100)}})):setTimeout(function(){a.unblock()},250)},unblock:function(){f.$component_selections.removeClass("refresh_component_options"),c.unblock(this.$blocked_element),this.$blocked_element=!1,c.data_model.remove_status_message(f.component_id),c.actions.do_action("component_options_refreshed_"+f.step_id)},is_updating:function(){return!1!==this.$blocked_element}}),h=new g(e);return h},this.Component_Selection_View=function(d,e){var f=d,g=b.View.extend({templates:{},$relocation_origin:!1,relocated:!1,relocate_component_content:!1,relocate_to_origin:!1,$relocation_target:!1,$relocation_reference:!1,load_height:0,resetting_product:!1,resetting_variation:!1,flushing_component_options:!1,initialize:function(){this.templates={selection_title:wp.template("wc_cp_component_selection_title"),selection_title_html:""},f.$el.on("change",".component_options select.component_options_select",{view:this},this.option_changed),f.$el.on("woocommerce_variation_has_changed",{view:this},function(a){a.data.view.model.update_selected_variation(),f.$component_quantity.trigger("change"),f.$component_summary_content.find(".composited_product_images").removeClass("images")}),f.$el.on("woocommerce_variation_select_change",function(){f.$component_summary.find(".composited_product_images").addClass("images"),f.$component_data.data("price",0),f.$component_data.data("regular_price",0);var a=f.$component_data.data("custom");a.price_tax=1}),f.$el.on("found_variation",function(a,b){f.$component_data.data("price",b.price),f.$component_data.data("regular_price",b.regular_price);var c=f.$component_data.data("custom");c.price_tax=b.price_tax}),f.$el.on("change",".component_wrap input.qty",function(){var b=parseFloat(a(this).attr("min")),c=parseFloat(a(this).attr("max"));b>=0&&(parseFloat(a(this).val())<b||isNaN(parseFloat(a(this).val())))&&a(this).val(b),c>0&&parseFloat(a(this).val())>c&&a(this).val(c),f.initializing_scripts||f.component_selection_model.update_selected_quantity()}),f.$el.on("wc-composite-component-loaded",{view:this},function(){if("yes"===wc_composite_params.photoswipe_enabled&&"undefined"!=typeof PhotoSwipe)f.$component_summary_content.find(".composited_product_images").wc_product_gallery({zoom_enabled:!1,flexslider_enabled:!1});else if(a.isFunction(a.fn.prettyPhoto)){var b=f.$component_summary_content.find('a[data-rel^="prettyPhoto"]'),c=b.not(".placeholder_image"),d=b.filter(".placeholder_image");c.length>0&&c.prettyPhoto({hook:"data-rel",social_tools:!1,theme:"pp_woocommerce",horizontal_padding:20,opacity:.8,deeplinking:!1}),d.length>0&&d.on("click",function(){return!1})}}),f.$el.on("click",".clear_component_options",function(){if(a(this).hasClass("reset_component_options"))return!1;var b=f.$component_options_select.find('option[value=""]');return b.length>0&&!1===b.first().prop("disabled")&&f.$component_options_select.val("").change(),!1}),f.$el.on("click",".reset_component_options",function(){var a=f.$component_options_select.find('option[value=""]');return f.unblock_step_inputs(),f.set_active(),a.length>0&&!1===a.first().prop("disabled")&&f.$component_options_select.val("").change(),f.block_next_steps(),!1}),f.$el.on("updated_addons",this.updated_addons_handler),f.$el.on("woocommerce-nyp-updated-item",this.updated_nyp_handler),"yes"===wc_composite_params.relocated_content_reset_on_return&&c.actions.add_action("active_step_transition_start",this.active_step_transition_start_handler,100,this),c.actions.add_action("options_state_changed_"+f.step_id,this.options_state_changed_handler,100,this),c.actions.add_action("options_state_render",this.options_state_render_handler,10,this),c.actions.add_action("options_state_rendered",this.options_state_rendered_handler,10,this),c.actions.add_action("component_selection_changed",this.refresh_selection_title,100,this),this.listenTo(this.model,"component_selection_details_loaded",this.selection_details_loaded),this.listenTo(this.model,"component_selection_details_load_error",this.selection_details_load_error),this.listenTo(f.component_options_model,"component_options_data_loaded",this.component_options_flush_handler),c.actions.add_action("component_quantity_changed",this.quantity_changed_handler,100,this)},get_animation_duration:function(a){var b=200;return a="open"!==a&&"close"!==a?"open":a,c.filters.apply_filters("component_selection_change_animation_duration",[b,a,f])},active_step_transition_start_handler:function(a){f.step_id!==a.step_id&&this.is_relocated()&&this.reset_relocated_content()},options_state_changed_handler:function(){this.update_selection_title()},options_state_render_handler:function(a,b){f.step_id===a.step_id&&_.contains(b,"thumbnails")&&this.is_relocated()&&f.$el.append(f.$component_content.hide())},options_state_rendered_handler:function(b,c){if(f.step_id===b.step_id&&_.contains(c,"thumbnails")&&this.is_relocated()){var d=this.get_content_relocation_params();d.relocate&&(this.$relocation_target=a('<li class="component_option_content_container">'),this.$relocation_reference=d.reference,this.$relocation_reference.after(this.$relocation_target),
f.$component_content.appendTo(this.$relocation_target),f.$component_content.show())}},quantity_changed_handler:function(a){a.step_id===f.step_id&&this.update_selection_title(this.model)},updated_addons_handler:function(){f.component_selection_model.update_selected_addons()},updated_nyp_handler:function(){f.component_selection_model.update_nyp()},refresh_selection_title:function(a){a.step_id===f.step_id&&this.update_selection_title(this.model)},update_selection_title:function(a){var b=this;a="undefined"==typeof a?b.model:a,f.get_selected_product(!1)>0&&(c.console_log("debug:views",'\nUpdating "'+f.get_title()+'" selection title...'),b.update_selection_title_task(a))},get_updated_selection_title:function(a){var b=parseInt(a.get("selected_quantity")),c=f.get_selected_product_title(!1),d=b>1?wc_composite_params.i18n_qty_string.replace("%s",b):"",e=wc_composite_params.i18n_title_string.replace("%t",c).replace("%q",d).replace("%p","");return e},update_selection_title_task:function(a){var b=f.$component_summary_content.find(".composited_product_title_wrapper"),c=this,d={show_title:"yes"===b.data("show_title"),show_selection_ui:!f.is_static(),show_reset_ui:f.show_placeholder_option()&&!1===f.maybe_is_optional()||f.is_optional()||!1===f.is_selected_product_valid(),selection_title:c.get_updated_selection_title(a)},e=c.templates.selection_title(d);e!==c.templates.selection_title_html&&(c.templates.selection_title_html=e,b.html(e))},init_dependencies:function(){f.init_scripts()},block:function(){f.has_options_style("thumbnails")?c.block(f.$component_thumbnail_options.find(".selected")):c.block(f.$component_options)},unblock:function(){f.has_options_style("thumbnails")?c.unblock(f.$component_thumbnail_options.find(".selected")):c.unblock(f.$component_options)},option_changed:function(b){var c=b.data.view,d=a(this).val();return a(this).blur(),c.set_option(d),!1},set_option:function(a){var b=this;if(f.get_selected_product(!1)===a)return!1;if(f.has_options_style("thumbnails"))f.$component_thumbnail_options.find(".selected").removeClass("selected"),f.$component_thumbnail_options.find("#component_option_thumbnail_"+a).addClass("selected");else if(f.has_options_style("radios")){var c=f.$component_radio_button_options.find(".selected");c.removeClass("selected"),c.find("input").prop("checked",!1),f.$component_options.find("#component_option_radio_button_"+(""===a?"0":a)).addClass("selected").find("input").prop("checked",!0)}""!==a?(this.block(),f.$component_content.addClass("updating"),setTimeout(function(){b.model.request_details(a)},120)):(this.model.selected_product="",this.selection_details_loaded(!1))},reset_option:function(){var a="";this.resetting_product=!0,this.set_option(a)},selection_details_load_error:function(){var a=f.get_selected_product(!1);if(f.$component_options_select.val(a).change(),this.unblock(),f.has_options_style("thumbnails"))f.$component_thumbnail_options.find(".selected").removeClass("selected"),f.$component_thumbnail_options.find("#component_option_thumbnail_"+a).addClass("selected");else if(f.has_options_style("radios")){var b=f.$component_radio_button_options.find(".selected");b.removeClass("selected"),b.find("input").prop("checked",!1),f.$component_options.find("#component_option_radio_button_"+(""===a?"0":a)).addClass("selected").find("input").prop("checked",!0)}f.$component_content.removeClass("updating"),window.alert(wc_composite_params.i18n_selection_request_timeout)},selection_details_loaded:function(b){var d=this,e=this.model.selected_product,g=this.relocations_allowed();if("undefined"!=typeof f.$component_content.get(0).getBoundingClientRect().height?d.load_height=f.$component_content.get(0).getBoundingClientRect().height:d.load_height=f.$component_content.outerHeight(),d.relocate_component_content=!1,d.relocate_to_origin=!1,d.$relocation_target=!1,d.$relocation_reference=!1,g&&!1===d.$relocation_origin&&(d.$relocation_origin=a('<div class="component_content_origin">'),f.$component_content.before(d.$relocation_origin)),g){var h=d.get_content_relocation_params();d.$relocation_reference=h.reference,d.relocate_component_content=h.relocate}else d.is_relocated()&&(d.relocate_component_content=!0,d.relocate_to_origin=!0);if(""!==e)if(d.relocate_component_content)if(d.relocate_to_origin)f.$component_content.animate({height:0},{duration:d.get_animation_duration("close"),queue:!1,always:function(){d.reset_relocated_content(),d.update_content(b.markup)}}),d.load_height=0;else{var i=f.$component_content.wc_cp_is_in_viewport(!0);d.relocated=!0,f.$component_content.addClass("relocated"),f.$component_content.addClass("relocating"),d.$relocation_target=a('<li class="component_option_content_container">'),d.$relocation_reference.after(d.$relocation_target);var j=f.$component_content.offset().top<d.$relocation_target.offset().top&&!i;if(j){var k=0,l=d.load_height,m=$wc_cp_document.height()-$wc_cp_window.scrollTop()-$wc_cp_window.height();d.load_height>m&&(l=m),k=$wc_cp_window.scrollTop()-Math.floor(l),setTimeout(function(){f.$component_content.css({height:l-Math.floor(l)}),window.scroll(0,k),setTimeout(function(){d.update_content(b.markup)},10)},100)}else f.$component_content.animate({height:0},{duration:d.get_animation_duration("close"),queue:!1,always:function(){d.update_content(b.markup)}});d.load_height=0}else f.$component_content.css("height",d.load_height),d.update_content(b.markup);else{var n=!0;if(d.resetting_product&&"single"!==c.settings.layout&&(n=!1),n){f.$component_data.data("product_type","none");var o=c.$composite_navigation_movable.is(":visible")?c.$composite_navigation_movable.outerHeight(!0):0,p=d.is_relocated()?0:f.$component_summary.outerHeight(!0)-f.$component_summary_content.innerHeight()-o;f.$component_content.animate({height:p},{duration:d.get_animation_duration("close"),queue:!1,always:function(){d.reset_content(),f.$component_content.css({height:"auto"})}})}else d.reset_content()}},update_content:function(a){var b=this;if(f.reset_scripts(),f.$component_summary_content.addClass("populated"),f.$component_summary_content.html(a),a.indexOf('data-product_type="invalid-product"')>0){var c=f.$component_options_select.find('option[value=""]');(0===c.length||c.first().prop("disabled"))&&f.$component_summary_content.find(".clear_component_options").remove()}b.relocate_component_content&&(f.$component_content.appendTo(b.$relocation_target),f.$component_options.find(".component_option_content_container").not(b.$relocation_target).remove()),this.templates.selection_title_html="",b.updated_content();var d=0,e=f.$component_summary_content.find(".composited_product_images"),g=e.find("img"),h=function(){e.length>0&&e.is(":visible")&&g.length>0&&0===g.height()&&d<1e3?(d+=50,setTimeout(function(){h()},50)):b.animate_updated_content()};setTimeout(function(){h()},300)},updated_content:function(){var a=this.resetting_product;this.model.selected_product>0?f.init_scripts():f.init_scripts(!1),this.resetting_product=!1,this.model.update_selected_product(),f.component_options_model.refresh_options_state(f),a&&f.component_options_view.render(),!0===f.$component_options_select.data("has_extra_empty_option")&&(f.$component_options_select.data("has_extra_empty_option",!1),f.component_options_view.render(!0))},animate_updated_content:function(){var a=f.$component_summary.outerHeight(!0),b=!1,d=this;this.relocate_component_content||Math.abs(a-this.load_height)>1?b=!0:f.$component_content.css("height","auto"),this.is_relocated()&&f.$component_content.removeClass("relocating"),b?(c.console_log("debug:events","Starting updated content animation..."),f.$component_content.animate({height:a},{duration:d.get_animation_duration("open"),queue:!1,always:function(){c.console_log("debug:events","Ended updated content animation."),wc_cp_scroll_viewport(f.$component_content,{offset:50,partial:"paged"!==c.settings.layout,scroll_method:"middle",duration:200,queue:!1,always_on_complete:!0,on_complete:function(){f.$component_content.css({height:"auto"}),d.unblock(),f.$component_content.removeClass("updating")}})}})):wc_cp_scroll_viewport(f.$component_content,{offset:50,partial:"paged"!==c.settings.layout,scroll_method:"middle",duration:200,queue:!1,always_on_complete:!0,on_complete:function(){d.unblock(),f.$component_content.removeClass("updating")}})},reset_content:function(){f.reset_scripts(),f.$component_summary_content.html('<div class="component_data" data-price="0" data-regular_price="0" data-product_type="none" style="display:none;"></div>'),f.$component_summary_content.removeClass("populated"),f.$el.find(".composite_navigation.movable").length>0&&c.$composite_navigation_movable.addClass("hidden"),this.templates.selection_title_html="",this.reset_relocated_content(),this.updated_content()},component_options_flush_handler:function(a,b){this.is_relocated()&&"reload"===b&&"success"===a.result&&(this.flushing_component_options=!0,this.reset_relocated_content(),this.flushing_component_options=!1)},reset_relocated_content:function(){this.is_relocated()&&(f.$component_message.hide(),this.flushing_component_options&&f.$component_content.hide(),f.component_selection_view.$relocation_origin.after(f.$component_content),this.flushing_component_options&&setTimeout(function(){f.$component_content.slideDown(250),wc_cp_scroll_viewport("relative",{offset:-f.$component_summary.outerHeight(!0),timeout:0,duration:250,queue:!1})},200),f.component_selection_view.$relocation_origin.remove(),f.component_selection_view.$relocation_origin=!1,f.$component_options.find(".component_option_content_container").remove(),!1===this.flushing_component_options&&""===this.model.selected_product&&wc_cp_scroll_viewport(f.$component_selections,{partial:!1,duration:250,queue:!1}),this.relocated=!1,f.$component_content.removeClass("relocated"))},relocations_allowed:function(){return!!("paged"===c.settings.layout&&f.append_results()&&f.has_options_style("thumbnails")&&!f.$el.hasClass("disable-relocations")&&f.$component_options.height()>$wc_cp_window.height())},is_relocated:function(){return this.relocated},get_content_relocation_params:function(){var a=!1,b=!1,c=f.$component_options.find(".component_option_thumbnail.selected").closest(".component_option_thumbnail_container"),d=c.outerWidth(!0)/f.$component_options.outerWidth(),e=c.hasClass("last")||d>.6?c:c.nextAll(".last").first();return b=e.length>0?e:f.$component_options.find(".component_option_thumbnail_container").last(),0===b.next(".component_option_content_container").length&&(a=!0),{reference:b,relocate:a}}}),h=new g(e);return h},this.Step_Title_View=function(d,e){var f=d,g=b.View.extend({$step_title_index:!1,initialize:function(){this.$step_title_index=f.$step_title.find(".step_index"),d.is_component&&f.has_toggle()&&(this.$el.on("click",this.clicked_title_handler),"progressive"===c.settings.layout&&(c.actions.add_action("step_access_changed",this.step_access_changed_handler,100,this),c.actions.add_action("active_step_changed",this.active_step_changed_handler,100,this))),!1!==this.$step_title_index&&c.actions.add_action("step_visibility_changed",this.step_visibility_changed_handler,100,this)},clicked_title_handler:function(){if(a(this).blur(),!f.has_toggle())return!1;if("single"===c.settings.layout)wc_cp_toggle_element(f.$el,f.$component_inner);else{if(f.is_current())return!1;if(a(this).hasClass("inactive"))return!1;c.navigate_to_step(f)}return!1},step_access_changed_handler:function(a){a.step_id===f.step_id&&this.render_navigation_state()},active_step_changed_handler:function(){this.render_navigation_state()},render_navigation_state:function(){"progressive"===c.settings.layout&&f.has_toggle()&&(c.console_log("debug:views",'\nUpdating "'+f.get_title()+'" component title state...'),f.is_current()?this.$el.removeClass("inactive"):f.is_locked()?this.$el.addClass("inactive"):this.$el.removeClass("inactive"))},render_index:function(){if(!c.is_initialized)return!1;if(!1===this.$step_title_index)return!1;var a=d.get_title_index();this.$step_title_index.text(a)},step_visibility_changed_handler:function(a){return!(f.step_index<a.step_index)&&void this.render_index()}}),h=new g(e);return h}},d.WC_CP_Actions_Dispatcher=function(b){var c=this,d={},e={add_action:function(a,b,c,e){var f={callback:b,priority:c,context:e},g=d[a];g?(g.push(f),g=this.sort_actions(g)):g=[f],d[a]=g},remove_action:function(a,b,c){var e,f,g;if(d[a])if(b)if(e=d[a],c)for(g=e.length;g--;)f=e[g],f.callback===b&&f.context===c&&e.splice(g,1);else for(g=e.length;g--;)e[g].callback===b&&e.splice(g,1);else d[a]=[]},sort_actions:function(a){for(var b,c,d,e=1,f=a.length;e<f;e++){for(b=a[e],c=e;(d=a[c-1])&&d.priority>b.priority;)a[c]=a[c-1],--c;a[c]=b}return a},do_action:function(a,b){var c,e,f=d[a];if(!f)return!1;for(e=f.length,c=0;c<e;c++)f[c].callback.apply(f[c].context,b);return!0}};this.init=function(){b.console_log("debug:events","\nInitializing Actions Dispatcher..."),a.each(b.get_steps(),function(a,d){d.is_component()&&(d.component_selection_model.on("change:selected_product change:selected_variation",function(){d.initializing_scripts||c.do_action("component_selection_changed",[d])}),d.component_selection_model.on("change:selected_quantity",function(){c.do_action("component_quantity_changed",[d])}),d.component_selection_model.on("change:selected_addons",function(){d.initializing_scripts||c.do_action("component_addons_changed",[d])}),d.component_selection_model.on("change:selected_nyp",function(){d.initializing_scripts||c.do_action("component_nyp_changed",[d])}),d.component_options_model.on("change:options_state",function(){c.do_action("options_state_changed",[d])}),d.component_options_model.on("change:active_options",function(){c.do_action("active_options_changed",[d])}),d.component_options_model.on("change:available_options",function(){c.do_action("available_options_changed",[d])}),b.data_model.on("change:component_"+d.step_id+"_totals",function(){c.do_action("component_totals_changed",[d])}),d.$el.on("woocommerce-composited-product-update",function(){d.initializing_scripts||c.do_action("component_selection_changed",[d])})),d.step_access_model.on("change:is_locked",function(){c.do_action("step_access_changed",[d])}),d.step_visibility_model.on("change:is_visible",function(){c.do_action("step_visibility_changed",[d])}),d.step_validation_model.on("change:composite_messages",function(){d.initializing_scripts||c.do_action("component_validation_message_changed",[d])}),d.step_validation_model.on("change:is_in_stock",function(){d.initializing_scripts||c.do_action("component_availability_changed",[d])})}),c.add_action("show_step",function(a){c.do_action("show_step_"+a.step_id)},0,this),c.add_action("active_step_changed",function(a){c.do_action("active_step_changed_"+a.step_id)},0,this),c.add_action("active_step_transition_start",function(a){c.do_action("active_step_transition_start_"+a.step_id)},0,this),c.add_action("active_step_transition_end",function(a){c.do_action("active_step_transition_end_"+a.step_id)},0,this),c.add_action("options_state_changed",function(a){c.do_action("options_state_changed_"+a.step_id)},0,this),c.add_action("active_options_changed",function(a){c.do_action("active_options_changed_"+a.step_id)},0,this),c.add_action("available_options_changed",function(a){c.do_action("available_options_changed_"+a.step_id)},0,this),c.add_action("component_options_loaded",function(a){c.do_action("component_options_loaded_"+a.step_id),a.$el.trigger("wc-composite-component-options-loaded",[a,b])},0,this),c.add_action("component_scripts_initialized",function(a){c.do_action("component_scripts_initialized_"+a.step_id),a.$el.trigger("wc-composite-component-loaded",[a,b])},0,this),c.add_action("component_scripts_reset",function(a){c.do_action("component_scripts_reset_"+a.step_id),a.$el.trigger("wc-composite-component-unloaded",[a,b])},0,this),b.scenarios.on("active_scenarios_changed",function(a){c.do_action("active_scenarios_changed",[a])}),b.scenarios.on("active_scenarios_updated",function(a){c.do_action("active_scenarios_updated",[a])}),b.data_model.on("change:totals",function(){c.do_action("composite_totals_changed")}),b.data_model.on("change:passes_validation",function(){c.do_action("composite_validation_status_changed")}),b.data_model.on("change:validation_messages",function(){c.do_action("composite_validation_message_changed")}),b.data_model.on("change:is_in_stock",function(){c.do_action("composite_availability_status_changed")}),b.data_model.on("change:stock_statuses",function(){c.do_action("composite_availability_message_changed")})},this.add_action=function(a,b,d,f){return"string"==typeof a&&"function"==typeof b&&(d=parseInt(d||10,10),e.add_action(a,b,d,f)),c},this.do_action=function(a,b){return"string"==typeof a&&e.do_action(a,b),c},this.remove_action=function(a,b){return"string"==typeof a&&e.remove_action(a,b),c}},d.WC_CP_Filters_Manager=function(){var a=this,b={},c={add_filter:function(a,c,d,e){var f={callback:c,priority:d,context:e},g=b[a];g?(g.push(f),g=this.sort_filters(g)):g=[f],b[a]=g},remove_filter:function(a,c,d){var e,f,g;if(b[a])if(c)if(e=b[a],d)for(g=e.length;g--;)f=e[g],f.callback===c&&f.context===d&&e.splice(g,1);else for(g=e.length;g--;)e[g].callback===c&&e.splice(g,1);else b[a]=[]},sort_filters:function(a){for(var b,c,d,e=1,f=a.length;e<f;e++){for(b=a[e],c=e;(d=a[c-1])&&d.priority>b.priority;)a[c]=a[c-1],--c;a[c]=b}return a},apply_filters:function(a,c){var d,e,f=b[a];if(!f)return c[0];for(e=f.length,d=0;d<e;d++)c[0]=f[d].callback.apply(f[d].context,c);return c[0]}};this.add_filter=function(b,d,e,f){return"string"==typeof b&&"function"==typeof d&&(e=parseInt(e||10,10),c.add_filter(b,d,e,f)),a},this.apply_filters=function(a,b){if("string"==typeof a)return c.apply_filters(a,b)},this.remove_filter=function(b,d){return"string"==typeof b&&c.remove_filter(b,d),a}},d.WC_CP_Scenarios_Manager=function(c){var d=this,e={updating_scenarios:!1,scenario_data:c.$composite_data.data("scenario_data"),active_scenarios:[],invalid_product_step_indexes:[],invalid_variation_step_indexes:[]};_.extend(d,b.Events),this.init=function(){c.actions.add_action("available_options_changed",this.available_options_changed_handler,-10,this),c.actions.add_action("component_selection_changed",this.selection_changed_handler,10,this),c.console_log("debug:events","\nInitializing Scenarios Manager..."),c.debug_tab_count=c.debug_tab_count+2,d.update_active_scenarios(_.first(c.steps),!1,!1),c.debug_tab_count=c.debug_tab_count-2,c.console_log("debug:events","\nScenarios Manager initialized.\n")},this.has_invalid_product=function(a){return _.contains(e.invalid_product_step_indexes,a)},this.has_invalid_variation=function(a){return _.contains(e.invalid_variation_step_indexes,a)},this.get_active_scenarios=function(){return e.active_scenarios},this.get_invalid_step_indexes=function(){return _.sortBy(_.uniq(_.union(e.invalid_product_step_indexes,e.invalid_variation_step_indexes)),function(a){return a})},this.get_scenario_data=function(){return e.scenario_data},this.set_component_scenario_data=function(a,b){e.scenario_data.scenario_data[a]=b},this.merge_component_scenario_data=function(b,c){a.each(c,function(a,c){e.scenario_data.scenario_data[b][a]=c})},this.selection_changed_handler=function(a){this.update_active_scenarios(a)},this.available_options_changed_handler=function(a){this.update_active_scenarios(a)},this.update_active_scenarios=function(a){if(c.console_log("debug:scenarios",'\nScenarios update triggered by event originating from "'+a.get_title()+'"...'),a.initializing_scripts)return c.console_log("debug:scenarios","Breaking out - event triggered during script init...\n\n"),!1;c.console_log("debug:scenarios","\nClearing incompatible products/variations data..."),e.invalid_product_step_indexes=[],e.invalid_variation_step_indexes=[];var b=e.active_scenarios;e.updating_scenarios=!0;var f=this.calculate_active_scenarios(a,!1,!1);e.updating_scenarios=!1,b.length!==f.length||b.length!==_.intersection(b,f).length?(c.console_log("debug:scenarios","\nActive scenarios changed: - ["+b+"] => ["+f+"]"),e.active_scenarios=f,d.trigger("active_scenarios_changed",a)):c.console_log("debug:scenarios","\nActive scenarios unchanged."),d.trigger("active_scenarios_updated",a)},this.calculate_active_scenarios=function(b,f,g){var h=b.step_index,i=d.get_scenario_data().scenarios,j=d.filter_scenarios_by_type(i,"compat_group");b.is_review()&&(h=1e3),0===j.length&&i.push("0");var k=i,l=[];e.updating_scenarios||c.console_log("debug:scenarios",'\nScenarios requested by "'+b.get_title()+'"...'),c.console_log("debug:scenarios","\nCalculating active scenarios..."),a.each(c.get_components(),function(a,b){if(g&&parseInt(b.step_index)===parseInt(h))return!0;if(f&&b.step_index>h)return!1;var i=b.get_selected_product(!1),j=b.get_selected_product_type();if(null!==i&&i>=0){var m=d.get_scenario_data().scenario_data,n=m[b.component_id];if(""===i){if(!(0 in n))return!0;i="0"}var o=i in n?n[i]:[];c.console_log("debug:scenarios","Selection #"+i+' of "'+b.get_title()+'" in scenarios: ['+o+"]");var p=_.intersection(k,o),q=p.length>0,r="",s=!0;if(q&&"variable"===j&&(r=b.get_selected_variation(!1),r>0)){var t=r in n?n[r]:[];c.console_log("debug:scenarios","Variation selection #"+r+' of "'+b.get_title()+'" in scenarios: ['+t+"]"),p=_.intersection(p,t),s=p.length>0}var u=q&&s;if(u)l.push(b.component_id),k=p,c.console_log("debug:scenarios","Active scenarios: ["+k+"]");else if(q){if(!s){var v="Incompatible variation selection found...";e.updating_scenarios&&r>0&&(v+=" saved.",e.invalid_variation_step_indexes.push(b.step_index)),c.console_log("debug:scenarios",v)}}else{var w="Incompatible product selection found...";e.updating_scenarios&&i>0&&(w+=" saved.",e.invalid_product_step_indexes.push(b.step_index)),c.console_log("debug:scenarios",w)}}}),c.console_log("debug:scenarios","Removing active scenarios where all scenario shaping components ("+l+") are masked...");var m=d.get_binding_scenarios(k,l);return c.console_log("debug:scenarios","Calculated active scenarios: ["+m+"]\n"),m},this.get_binding_scenarios=function(b,c){var d=this.get_scenario_data().scenario_settings.masked_components,e=[];if(c.length>0){if(b.length>0)for(var f=0;f<b.length;f++){for(var g=b[f],h=!0,i=0;i<c.length;i++){var j=c[i];if(a.inArray(j.toString(),d[g])==-1){h=!1;break}}h||e.push(g)}}else e=b;return 0===e.length&&b.length>0&&(e=b),e},this.get_active_scenarios_by_type=function(a){return this.filter_scenarios_by_type(e.active_scenarios,a)},this.get_scenarios_by_type=function(a){return this.filter_scenarios_by_type(this.get_scenario_data().scenarios,a)},this.filter_scenarios_by_type=function(b,c){var d=[],e="";if(b.length>0)for(var f=0;f<b.length;f++)e=b[f],("all"===c||a.inArray(c,this.get_scenario_data().scenario_settings.scenario_actions[e])>-1)&&d.push(e);return d},this.clean_masked_scenarios=function(b,c){var d=this.get_scenario_data().scenario_settings.masked_components,e=[],f="";if(b.length>0)for(var g=0;g<b.length;g++)f=b[g],a.inArray(c.toString(),d[f])==-1&&e.push(f);return e},this.get_masked_scenarios=function(b,c){var d=this.get_scenario_data().scenario_settings.masked_components,e=[],f="";if(b.length>0)for(var g=0;g<b.length;g++)f=b[g],a.inArray(c.toString(),d[f])>-1&&e.push(f);return e}},d.WC_CP_Step_Factory=function(){function b(b,c,d){var e=this;this.step_id=c.data("item_id"),this.step_index=d,this.step_title=c.data("nav_title"),this.step_slug=b.$composite_data.data("composite_settings").slugs[this.step_id],this._component_messages=[],this._composite_messages=[],this._is_component=c.hasClass("component"),this._is_review=c.hasClass("cart"),this._is_current=c.hasClass("active"),this._is_previous=c.hasClass("prev"),this._is_next=c.hasClass("next"),this._toggled=c.hasClass("toggled"),this._autotransition=c.hasClass("autotransition"),this.$el=c,this.$inner_el=c.find(".component_inner"),this.$step_title=c.find(".step_title_wrapper"),this.$self=c,this.add_actions=function(){"single"===b.settings.layout?b.actions.add_action("show_step_"+e.step_id,this.autoscroll_single,10,this):"paged"===b.settings.layout?(b.actions.add_action("active_step_changed",this.autoscroll_paged,120,this),b.actions.add_action("active_step_transition_end_"+e.step_id,this.autoscroll_paged_relocated,10,this)):"progressive"===b.settings.layout&&b.actions.add_action("active_step_transition_end_"+e.step_id,this.autoscroll_progressive,10,this),b.actions.add_action("step_visibility_changed",this.step_visibility_changed_handler,10,this)},this.step_visibility_changed_handler=function(){return"paged"!==b.settings.layout&&(!1===e.is_visible()?b.is_initialized?e.$el.slideUp(200):e.$el.hide():e.$el.slideDown(200)),!!b.is_initialized&&void(this.is_current()&&b.set_current_step(b.get_current_step()))},this.autoscroll_single=function(){var a=b.is_initialized!==!1;a&&wc_cp_scroll_viewport(e.$el,{partial:!1,duration:250,queue:!1})},this.autoscroll_paged=function(a){if(e.step_id===a.step_id){var c=b.is_initialized!==!1,d=e.is_component(),f=!!d&&e;d&&f.component_selection_view.is_relocated()||c&&wc_cp_scroll_viewport(b.$composite_transition_helper,{timeout:20,partial:!1,duration:250,queue:!1})}},this.autoscroll_paged_relocated=function(){var a=b.is_initialized!==!1,c=e.is_component(),d=!!c&&e;c&&d.component_selection_view.is_relocated()&&a&&wc_cp_scroll_viewport(d.$component_content,{timeout:0,partial:!1,duration:250,queue:!1,scroll_method:"middle"})},this.autoscroll_progressive=function(){var a=b.is_initialized!==!1;a&&e.$el.hasClass("autoscrolled")&&(e.$step_title.wc_cp_is_in_viewport(!1)||wc_cp_scroll_viewport(e.$el,{timeout:0,partial:!1,duration:250,queue:!1}))},this.autotransition=function(){return this._autotransition},this.is_animating=function(){return this.$el.hasClass("animating")},this.has_toggle=function(){return this._toggled},this.is_locked=function(){var a=this.step_access_model.get("is_locked");return b.filters.apply_filters("step_is_locked",[a,this])},this.is_visible=function(){return this.step_visibility_model.get("is_visible")},this.lock=function(){this.step_access_model.set({locked:!0})},this.unlock=function(){this.step_access_model.set({locked:!1})},this.get_title_index=function(){var a=_.filter(b.get_steps(),function(a){if(!1===a.step_visibility_model.get("is_visible")&&a.step_index<e.step_index)return a}).length;return this.step_index+1-a},this.get_title=function(){return this.step_title},this.get_element=function(){return this.$el},this.is_review=function(){return this._is_review},this.is_component=function(){return this._is_component},this.get_component=function(){return!!this._is_component&&this},this.is_current=function(){return this._is_current},this.is_next=function(){return this._is_next},this.is_previous=function(){return this._is_previous},this.show_step=function(){if(this.is_locked()||this.is_animating())return!1;var a=this.is_current();"single"===b.settings.layout&&this.toggle_step("open",!0),a&&b.is_initialized||this.set_active(),b.actions.do_action("show_step",[this])},this.set_active=function(){var a=this,c=b.settings.layout,d=b.get_current_step(),e=d.$el,f=a.$el,g=0;b.set_current_step(a),d.step_id!==a.step_id?"paged"===c?(b.$composite_form_blocker.addClass("blocked"),b.has_transition_lock=!0,setTimeout(function(){e.addClass("faded"),f.addClass("invisible faded"),setTimeout(function(){g="undefined"!=typeof e.get(0).getBoundingClientRect().height?e.get(0).getBoundingClientRect().height:e.outerHeight(),e.addClass("invisible"),e.css("height",g),b.actions.do_action("active_step_transition_start",[a]),b.console_log("debug:events","Starting transition..."),e.slideUp({duration:150,always:function(){e.css("height","auto")}}),f.slideDown({duration:150,always:function(){setTimeout(function(){b.actions.do_action("active_step_transition_end",[a])},250),b.console_log("debug:events","Transition ended."),setTimeout(function(){b.$steps.removeClass("faded invisible")},10),b.has_transition_lock=!1,b.$composite_form_blocker.removeClass("blocked")}})},250)},10)):("progressive"===c&&a.update_block_state(),b.has_transition_lock=!0,setTimeout(function(){b.actions.do_action("active_step_transition_start",[a])},5),setTimeout(function(){b.actions.do_action("active_step_transition_end",[a]),b.has_transition_lock=!1},350)):a.$el.show(),b.actions.do_action("active_step_changed",[this])},this.update_block_state=function(){var c=b.settings.layout;return"progressive"===c&&(a.each(b.get_steps(),function(a,b){b.step_index<e.step_index&&(b.block_step_inputs(),b.$el.hasClass("block-open")||b.toggle_step("closed",!0))}),this.unblock_step_inputs(),this.unblock_step(),void this.block_next_steps())},this.unblock_step=function(){this.toggle_step("open",!0),this.$el.removeClass("blocked")},this.block_next_steps=function(){var c=this.step_index;a.each(b.get_steps(),function(a,b){a>c&&(b.$el.hasClass("disabled")&&b.unblock_step_inputs(),b.block_step())})},this.block_step=function(){this.$el.addClass("blocked"),this.toggle_step("closed",!1)},this.toggle_step=function(a,b,c){this.has_toggle()&&("open"===a?this.$el.hasClass("closed")&&wc_cp_toggle_element(this.$el,this.$inner_el,c):"closed"===a&&this.$el.hasClass("open")&&wc_cp_toggle_element(this.$el,this.$inner_el,c),b?this.$step_title.removeClass("inactive"):this.$step_title.addClass("inactive"))},this.unblock_step_inputs=function(){this.$el.removeClass("disabled");var a=this.$el.find(".clear_component_options");a.html(wc_composite_params.i18n_clear_selection).removeClass("reset_component_options")},this.block_step_inputs=function(){if(this.$el.addClass("disabled"),!e.has_toggle()||e.$el.hasClass("block-open")){var a=this.$el.find(".clear_component_options");a.html(wc_composite_params.i18n_reset_selection).addClass("reset_component_options")}},this.is_blocked=function(){return this.$el.hasClass("blocked")},this.has_blocked_inputs=function(){return this.$el.hasClass("disabled")},this.add_validation_message=function(a,b){b="undefined"==typeof b?"component":b,"composite"===b?this._composite_messages.push(a.toString()):this._component_messages.push(a.toString())},this.get_validation_messages=function(a){var c;return a="undefined"==typeof a?"component":a,c="composite"===a?this._composite_messages:this._component_messages,b.filters.apply_filters("step_validation_messages",[c,a,this])},this.validate=function(){if(e.initializing_scripts)return!1;var a=this,c=!0,d=!0;if(this._component_messages=[],this._composite_messages=[],this.is_component()){var f=this.get_selected_product(),g=this.get_selected_variation(),h=this.get_selected_product_type();c=!1,""===f&&this.is_optional()?c=!0:f>0&&("variable"===h?(g>0||0===this.get_selected_quantity())&&(c=!0):"simple"===h||"none"===h?c=!0:this.$component_data.data("component_set")!==!0&&0!==this.get_selected_quantity()||(c=!0)),c=!this.is_visible()||b.filters.apply_filters("step_is_valid",[c,this]),c||(f>0?"invalid-product"===h?this.add_validation_message(wc_composite_params.i18n_item_unavailable_text,"composite"):"variable"===h&&(this.is_selected_variation_valid()?(this.add_validation_message(wc_composite_params.i18n_select_product_options),this.add_validation_message(wc_composite_params.i18n_select_product_options_for,"composite")):this.add_validation_message(wc_composite_params.i18n_selected_product_options_invalid,"composite")):this.is_selected_product_valid()?(this.add_validation_message(wc_composite_params.i18n_select_component_option),this.add_validation_message(wc_composite_params.i18n_select_component_option_for,"composite")):(this.add_validation_message(wc_composite_params.i18n_selected_product_invalid),this.add_validation_message(wc_composite_params.i18n_selected_product_invalid,"composite"))),this.is_in_stock()||(d=!1),b.actions.do_action("validate_step",[a,c])}this.step_validation_model.update(c,d)},this.passes_validation=function(){return this.step_validation_model.get("passes_validation")},this.add_actions()}function c(c,d,e){b.call(this,c,d,e);var f=this;this.initializing_scripts=!1,this.component_index=e,this.component_id=d.attr("data-item_id"),this.component_title=d.data("nav_title"),
this._hide_disabled_products=d.hasClass("hide-incompatible-products"),this._hide_disabled_variations=d.hasClass("hide-incompatible-variations"),this._is_static=d.hasClass("static"),this.$component_summary=d.find(".component_summary"),this.$component_summary_content=d.find(".component_summary > .content"),this.$component_selections=d.find(".component_selections"),this.$component_content=d.find(".component_content"),this.$component_options=d.find(".component_options"),this.$component_filters=d.find(".component_filters"),this.$component_ordering=d.find(".component_ordering select"),this.$component_options_inner=d.find(".component_options_inner"),this.$component_inner=d.find(".component_inner"),this.$component_pagination=d.find(".component_pagination"),this.$component_message=d.find(".component_message"),this.$component_data=this.$component_summary_content.find(".component_data"),this.$component_quantity=this.$component_summary_content.find(".component_wrap input.qty"),this.$component_options_select=this.$component_options.find("select.component_options_select"),this.$component_thumbnail_options=this.$component_options.find(".component_option_thumbnails"),this.$component_radio_button_options=this.$component_options.find(".component_option_radio_buttons"),this.append_results=function(){return"yes"===c.$composite_data.data("composite_settings").pagination_data[this.step_id].append_results},this.get_results_per_page=function(){return c.$composite_data.data("composite_settings").pagination_data[this.step_id].results_per_page},this.get_max_results=function(){return c.$composite_data.data("composite_settings").pagination_data[this.step_id].max_results},this.get_pagination_range=function(a){"undefined"==typeof a&&(a="mid");var b="end"===a?"pagination_range_end":"pagination_range";return c.$composite_data.data("composite_settings").pagination_data[this.step_id][b]},this.get_selected_product=function(a){return"undefined"==typeof a&&(a=!0),a&&!this.is_selected_product_valid()?null:this.component_selection_model.get("selected_product")},this.get_selected_variation=function(a){return"undefined"==typeof a&&(a=!0),a&&!this.is_selected_variation_valid()?null:this.component_selection_model.get("selected_variation")},this.get_selected_quantity=function(){return!1===f.is_visible()?0:this.component_selection_model.get("selected_quantity")},this.get_selected_product_type=function(){return this.$component_data.data("product_type")},this.get_selected_product_title=function(a,b){if(b="undefined"!=typeof b&&b,a="undefined"!=typeof a&&a,b&&!this.is_selected_product_valid())return"";var d=this.find_selected_product_param("title"),e=this.get_selected_quantity(),f=this.get_selected_product(!1),g="",h="",i="";return d=c.filters.apply_filters("component_selection_title",[d,this]),d&&a&&(""===f?g='<span class="content_product_title none">'+d+"</span>":(i=e>1?"<strong>"+wc_composite_params.i18n_qty_string.replace("%s",e)+"</strong>":"",g=wc_composite_params.i18n_title_string.replace("%t",d).replace("%q",i).replace("%p",""),h=this.get_selected_product_meta(!0),h&&(g=wc_composite_params.i18n_selected_product_string.replace("%t",g).replace("%m",h)),g='<span class="content_product_title">'+g+"</span>"),g=c.filters.apply_filters("component_selection_formatted_title",[g,d,e,h,this])),a?g:d},this.get_selected_product_meta=function(b){b="undefined"!=typeof b&&b;var d="",e=this.get_selected_variation(!1)>0?this.component_selection_model.selected_variation_data:[];return e=c.filters.apply_filters("component_selection_meta",[e,this]),e.length>0&&b&&(d='<ul class="content_product_meta">',a.each(e,function(a,b){d=d+'<li class="meta_element"><span class="meta_key">'+b.meta_key+':</span> <span class="meta_value">'+b.meta_value+"</span>",a!==e.length-1&&(d+='<span class="meta_element_sep">, </span>'),d+="</li>"}),d+="</ul>",d=c.filters.apply_filters("component_selection_formatted_meta",[d,e,this])),b?d:e},this.get_selected_product_image_data=function(a){return a="undefined"==typeof a||a,!(a&&!this.is_selected_product_valid())&&(this.get_selected_variation(a)>0&&this.component_selection_model.selected_variation_image_data?this.component_selection_model.selected_variation_image_data:this.component_selection_model.selected_product_image_data)},this.is_selected_product_valid=function(a){return"undefined"==typeof a&&(a=this.component_options_model.get("active_options")),""===this.component_selection_model.get("selected_product")||_.contains(a,this.component_selection_model.get("selected_product"))},this.is_selected_variation_valid=function(a){return"undefined"==typeof a&&(a=this.component_options_model.get("active_options")),""===this.component_selection_model.get("selected_variation")||_.contains(a,this.component_selection_model.get("selected_variation"))},this.hide_disabled_products=function(){return c.filters.apply_filters("component_hide_disabled_products",[this._hide_disabled_products,this])},this.hide_disabled_variations=function(){return c.filters.apply_filters("component_hide_disabled_variations",[this._hide_disabled_variations,this])},this.find_selected_product_param=function(b){if("id"===b)return c.console_log("error","\nMethod 'WC_CP_Component::find_selected_product_param' was called with a deprecated argument value ('id'). Use 'WC_CP_Component::get_selected_product' instead."),this.get_selected_product(!1);if("variation_id"===b)return"variable"===this.get_selected_product_type()?this.$component_summary_content.find(".single_variation_wrap .variations_button input.variation_id").val():"";if("title"===b){var d=this.get_selected_product(!1),e="";return""===d?e=wc_composite_params.i18n_no_selection:""!==d&&this.component_options_model.available_options_data.length>0&&a.each(this.component_options_model.available_options_data,function(a,b){if(b.option_id===d)return e=b.option_title,!1}),e}if("variation_data"===b){var f=this.$component_summary_content.find(".variations");return f.length>0?wc_cp_get_variation_data(f,!1):[]}if("product_image_data"===b){var g=this.$component_data.data("custom"),h=!1;return g&&"undefined"!=typeof g.image_data&&(h={image_src:g.image_data.image_src,image_srcset:g.image_data.image_srcset,image_sizes:g.image_data.image_sizes,image_title:g.image_data.image_title}),h}if("variation_image_data"===b){var i=this.find_selected_product_param("variation_id"),j=this.$component_data.data("product_variations"),k=!1;return i>0&&j&&a.each(j,function(a,b){if(parseInt(b.variation_id)===parseInt(i))return"yes"===wc_composite_params.is_wc_version_gte_2_7&&b.image?k={image_src:b.image.src,image_srcset:b.image.srcset,image_sizes:b.image.sizes,image_title:b.image.title}:b.image_src&&(k={image_src:b.image_src,image_srcset:b.image_srcset,image_sizes:b.image_sizes,image_title:b.image_title}),!1}),k}if("quantity"===b){var l=this.$component_quantity.length>0?this.$component_quantity.val():0;return parseInt(l)}if("addons_price"===b){var m=this.$component_summary_content.find(".component_wrap #product-addons-total"),n=m.length>0?m.data("addons-raw-price"):0;return Number(n)}if("nyp_price"===b){var o=this.$component_summary_content.find(".nyp"),p=o.length>0?o.data("price"):0;return Number(p)}},this.find_pagination_param=function(a){var b=f.$component_pagination.data("pagination_data"),c=1;return b&&("page"===a?c=b.page:"pages"===a&&(c=b.pages)),c},this.find_order_by=function(){var a="";return this.$component_ordering.length>0&&(a=this.$component_ordering.val()),a},this.find_active_filters=function(){var b=this.$component_filters,c={};return 0==b.length?c:(b.find(".component_filter_option.selected").each(function(){var b=a(this).closest(".component_filter").data("filter_type"),d=a(this).closest(".component_filter").data("filter_id"),e=a(this).data("option_id");b in c?d in c[b]?c[b][d].push(e):(c[b][d]=[],c[b][d].push(e)):(c[b]={},c[b][d]=[],c[b][d].push(e))}),c)},this.find_options_data=function(){return f.$component_options.data("options_data")},this.is_in_stock=function(){var a=!0;return this.$component_summary_content.find(".component_wrap .out-of-stock").not(".inactive").length>0&&this.get_selected_quantity()>0&&("variable"!==this.get_selected_product_type()||this.get_selected_variation(!1)>0)&&(a=!1),a},this.is_nyp=function(){return this.component_selection_model.get("selected_nyp")>0},this.has_options_style=function(a){return this.$el.hasClass("options-style-"+a)},this.get_bundle_script=function(){var a=!1;return"undefined"!=typeof wc_pb_bundle_scripts[f.component_id]&&(a=wc_pb_bundle_scripts[f.component_id]),a},this.init_scripts=function(b){if("undefined"==typeof b&&(b=!0),this.$component_data=this.$component_summary_content.find(".component_data"),this.$component_quantity=this.$component_summary_content.find(".component_wrap input.qty"),b){f.initializing_scripts=!0,f.init_qty_input();var d=this.get_selected_product_type(),e=this.$component_summary_content;"variable"===d?(e.hasClass("cart")||e.addClass("cart"),e.hasClass("variations_form")||e.addClass("variations_form"),e.data("product_variations",this.$component_data.data("product_variations")),a.each(this.$component_data.data("product_variations"),function(a,b){f.component_options_model.attributes.active_options.push(b.variation_id.toString())}),e.wc_variation_form(),e.find(".variations select").change(),e.find("div").stop(!0,!0)):"bundle"===d?(e.hasClass("bundle_form")||e.addClass("bundle_form"),e.find(".bundle_data").wc_pb_bundle_form(),e.find("div").stop(!0,!0)):e.hasClass("cart")||e.addClass("cart"),f.initializing_scripts=!1}c.actions.do_action("component_scripts_initialized",[f])},this.reset_scripts=function(){f.$component_summary_content.removeClass("variations_form bundle_form cart"),f.$component_summary_content.off().find("*").off(),c.actions.do_action("component_scripts_reset",[f])},this.get_step=function(){return c.get_step(this.component_id)},this.is_static=function(){return this._is_static},this.is_optional=function(){var a=_.contains(this.component_options_model.get("active_options"),"");return c.filters.apply_filters("component_is_optional",[a,this])},this.maybe_is_optional=function(){var a=c.scenarios.get_scenario_data().scenario_data,b=a[f.component_id];return 0 in b},this.show_placeholder_option=function(){return"yes"===c.$composite_data.data("composite_settings").show_placeholder_option[this.step_id]},this.is_selected_product_price_visible=function(){return"yes"===c.$composite_data.data("composite_settings").selected_product_price_visibility_data[this.step_id]},this.is_subtotal_visible=function(){return"yes"===c.$composite_data.data("composite_settings").subtotal_visibility_data[this.step_id]},this.init_qty_input=function(){"no"!==wc_composite_params.is_wc_version_gte_2_3&&"yes"!==wc_composite_params.show_quantity_buttons||this.$component_summary_content.find("div.quantity:not(.buttons_added), td.quantity:not(.buttons_added)").addClass("buttons_added").append('<input type="button" value="+" class="plus" />').prepend('<input type="button" value="-" class="minus" />'),this.$component_quantity.trigger("change")},this.get_placeholder_image_data=function(){return"undefined"!=typeof c.$composite_data.data("composite_settings").image_data[this.step_id]&&c.$composite_data.data("composite_settings").image_data[this.step_id]},this.get_selected_product_id=function(){return this.find_selected_product_param("id")}}this.create_component=function(a,d,e){return c.prototype=this.create(b.prototype),c.prototype.constructor=c,new c(a,d,e)},this.create_step=function(a,c,d){return c.hasClass("component")?this.create_component(a,c,d):new b(a,c,d)},this.create=function(a){function b(){}return b.prototype=a,new b}},$wc_cp_document.ready(function(){$wc_cp_body=a(document.body),$wc_cp_body.on("quick-view-displayed",function(){a(".composite_form .composite_data").each(function(){a(this).wc_composite_form()})}),$wc_cp_window.resize(function(){a.each(wc_cp_composite_scripts,function(a,b){clearTimeout(b.timers.on_resize_timer),b.timers.on_resize_timer=setTimeout(function(){b.on_resize_handler()},50)})}),a.fn.wc_composite_form=function(){if(!a(this).hasClass("composite_data"))return!0;var b=a(this).data("container_id"),d=a(this).closest(".composite_form");"undefined"!=typeof wc_cp_composite_scripts[b]&&d.find("*").off(),wc_cp_composite_scripts[b]=new c({$composite_form:d,$composite_data:a(this)}),d.data("script_id",b),wc_cp_composite_scripts[b].init()},a(".composite_form .composite_data").each(function(){a(this).wc_composite_form()})})}(jQuery,Backbone);